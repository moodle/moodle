/**
 * @copyright  Pimenko 2019
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_pimenko/pimenko",["jquery","core/ajax"],(function($,ajax){let scrollHandler=function(){const body=document.querySelector("body");getScrollPosition()>=window.innerHeight?body.classList.add("scrolled"):body.classList.remove("scrolled")},getScrollPosition=function(){return window.pageYOffset||document.documentElement.scrollTop};return{init:function(){$((function(){$("#completion-block").tooltip({trigger:"hover"})})),$(".cover_file").on("change",(function(event){let courseid=$(this).data("id");if(courseid){let file=event.target.files[0],filedata=null;if(!file.type.match("image.*"))return;let reader=new FileReader;reader.onload=function(file){return function(e){filedata=e.target.result;let imagedata=filedata.split("base64,")[1],filename=file.name,fileconverted=filedata,byteString=atob(fileconverted.split(",")[1]),mimeString=fileconverted.split(",")[0].split(":")[1].split(";")[0],arrayBuffer=new ArrayBuffer(byteString.length),_ia=new Uint8Array(arrayBuffer);for(let i=0;i<byteString.length;i++)_ia[i]=byteString.charCodeAt(i);let dataView=new DataView(arrayBuffer);fileconverted=new Blob([dataView],{type:mimeString}),ajax.call([{methodname:"theme_pimenko_save_cover_file",args:{imagedata:imagedata,courseid:courseid,filename:filename,filedelete:!1},done:function(response){response.success&&window.location.reload(!0)},fail:function(response){console.log(response),console.log("fail")}}],!0,!0)}}(file),reader.readAsDataURL(file)}})),$(".delete-cover").on("click",(function(){let selector=$(".cover_file"),courseid=selector.data("id"),filename=selector.data("name");courseid&&ajax.call([{methodname:"theme_pimenko_save_cover_file",args:{courseid:courseid,filename:filename,filedelete:!0},done:function(response){response.success&&window.location.reload(!0)},fail:function(response){console.log(response),console.log("fail")}}],!0,!0)})),this.scrollY=0,window.addEventListener("scroll",scrollHandler.bind(this))}}}));

//# sourceMappingURL=pimenko.min.js.map