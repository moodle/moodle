<p align="center"><b>「Course Test Manager」フォーマットファイルのインポート</b></p>

<p>Course Test Managerは、Course Technology社による「開発を終了した」ソフトウェアパッケージです。 
現在は、Course Technologyによる積極的な開発は行われていません。
ExamViewと呼ばれる新しいテストマネージャーが、Course Test Managerの後を継いでいます。
しかしながら、今までCTMテストバンクからエクスポートされたフォーマットの移行手段が存在しませんでした。
これが、このモジュールが作成された理由です。</p>

<p>CTMから問題をインポートするためには、WindowsマシンにCTMをインストールして、そのマシンのMS Accessデータファイル
にアクセスする必要があります。データファイルにアクセスするために、下記の2つのファイルが必要です:</p>
<ul><li>System.mda - このファイルはCTMディレクトリのルートディレクトリにあり、MS Accessより「システムデータベース」として認識されます。</li>
<li>ctm.mdb - これはテストバンク問題を含んでいるデータベースです。CTMにインストールされたそれぞれのコースには、1つのctm.mdbデータベース
が作成されます。ctm.mdbはCTMインストールディレクトリの下位ディレクトリに保存されます。</li>
</ul>

</p>重要な処理は、あなたがmoodleをWindowsで動作しているか、Linuxで動作しているかによって幾分異なります。
どのようなプラットフォームでmoodleを動かしていても、Accessデータベースからテストバンクをインポートするために、
同一ネットワーク内にWindowsシステム(Windows 2000 または Windows XP)を置く必要があります。</p>

<p>処理方法は、<b>Windowsベース</b>のmoodleシステムの方が幾分簡単です。CTMインポートクラスを使用するために必要なことは:</p>

<ol><li>ファイルマネージャーを使って、system.mdaシステムデータベースをmoodleにアップロードしてください。
どのコースに、system.mdaをアップロードしてもかまいません。Moodleが自動的にインポート先を判断します。</li>
<li>小テストを作成して、「ファイルから小テストをインポートする」の画面に進んでください。選択したctm.mdb
データベースをインポートファイルとしてアップロードしてください。アップロードが正常にできない場合、次の画面で
データベースからインポートするための、問題のサブカテゴリを選択することができます。 このステップがある理由は、
CTMテストバンクがしばしば、本の章またはコースのセクションのようにカテゴリ分けされた大量の問題を含んでいることが
あるからです。</li></ol>

<p><b>Linuxベース</b>のmoodleシステムでは、<a href="http://odbcsock.sourceforge.net/" target="_new"><b>ODBCソケットサーバ</b></a>
と呼ばれるサードパーティのソフトウェアコンポーネントが必要です。LinuxにCTMデータベースをインポートするには、最初にこの小さな
ネットワークプログラムを、CTMデータベースを入れているWindowsシステムにダウンロードしてインストールする必要があります。
ODBCソケットサーバのインストール手順に<b>従わないで</b>ください。それらは、必要以上に更に複雑になっています! 
代わりに、下記の手順に従って、あなたのWindowsシステムにこのプログラムをインストールしてください:</p>

<ol><li>Windowsシステムに移って、<a href="http://odbcsock.sourceforge.net/" target="_new">
このサイト</a>よりダウンロードしたファイルをunzipしてください。</li>
<li>Copy the binary ODBCSocketServer.exeバイナリを、システムディレクトリ(恐らく C:\WINNT\ または C:\Windows)
または、Program Filesディレクトリ等の、削除することの無い場所にコピーしてください。</li> 

<li>次のコマンドを使って、ODBCソケットサーバをサービスとしてインストールしてください:<br />
<b>&lt;path you copied the file to in the step above&gt;ODBCSocketServer.exe /Service</b><br />
このコマンドは、スタート-&gt;ファイル名を... 画面、またはコマンドプロンプトから実行することができます。</li>

<li>スタート-&gt;設定-&gt;コントロールパネル-&gt;管理ツール-&gt;サービスを選択するか、<b>マイ コンピュータ</b>を右クリックして、
<b>管理</b>を選択、次に<b>サービスとアプリケーション-&gt;サービス</b>を選択して右側のパネルにてサービスマネージャーを開いてください。
または、スタート-&gt;ファイル名を... 画面で<b>services.msc</b>と入力することで、サービスマネージャーを開くことができます。</li>

<li>サービスマネージャーで、ODBC Socket Serverを選んでマウスの右ボタンをクリックして、<b>開始</b>を選択してください。
ODBC Socket Serverの状態が「開始」に変わります。インポート作業が完了した後に、このサービスを停止または無効にしてください。</li>

<li>system.mdaとctm.mdbのAccessデータファイルがWindowsマシン内にあり、MS Access ODBCドライバがインストールされていることを
確認してください。これは、通常のWindowsにインストールされています。「管理ツール」の「データ ソース (ODBC)」を開いて「ドライバ」タブで、
MS Access ODBCドライバがインストールされているか確認することができます。

CTMをどこにインストールするか、system.mdaとctm.mdaデータベースをどこに置くか、またはデータベースをどこからインポートするか決めてください。
WindowsサーバのIPアドレスまたはホスト名と同様に、これらのファイルへはフルパスを指定してください。重要な処理を行うために、この情報が必要です。</li>

<li>これでテストバンクをmoodleにインポートする準備ができました。「ファイルから小テストをインポートする」を使用して、あなたの小テストを
作成してください。<b>ここからLINUXサーバで設定が異なる部分を挙げます - </b>
インポートプロセスを開始させるために、アップロードフィールドにダミーファイルを指定してください。このフィールドに入れたファイルは、<b>処理されません</b>。
ここでは、インポートフォームに対する代替的な値を入れるだけです。次に、Windowsサーバに関する情報を指定する画面が表示されます。次に、system及びtestbank
データベースと同様に、Windows ODBC Socket Serverのホスト名を入力する画面が表示されます。前のステップで指定した情報を入力して、「サーバに接続する」ボタンを
クリックしてください。全てが正しく設定された場合、データベースから問題をインポートするために、サブカテゴリを選択するフォームが表示されます。
このステップがある理由は、CTMテストバンクがしばしば、本の章またはコースのセクションのようにカテゴリ分けされた大量の問題を含んでいることがあるからです。
あなたがこのステップにエラーメッセージ無しに到達した場合、Socket Serverの設定は正しく設定されて、問題をMOODLEにインポートするところまで来ています!</li>
</ol>

<p>処理の途中でエラーメッセージが表示された場合、あなたはこの技術情報が便利であることに気付くでしょう。ODBC Socket serverは、ソケットをオープンして、
XMLクエリーがクエリー結果用XMLテーブルを利用できるように、ポート9628を使用します。インポートにおいて、この重要なXML用クラスは、ローカルクエリーと同じように
クエリーを実行できるような働きをします。</p>
