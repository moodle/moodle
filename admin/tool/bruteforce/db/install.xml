<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="admin/tool/bruteforce/db" VERSION="2025031600" COMMENT="Brute force protection plugin tables" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../../lib/xmldb/xmldb.xsd">
    <TABLES>
        <TABLE NAME="tool_bruteforce_log" COMMENT="Records login attempts">
            <FIELDS>
                <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
                <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="false"/>
                <FIELD NAME="ip" TYPE="char" LENGTH="45" NOTNULL="true"/>
                <FIELD NAME="status" TYPE="char" LENGTH="20" NOTNULL="true" COMMENT="success or failure"/>
                <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true"/>
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
            </KEYS>
            <INDEXES>
                <INDEX NAME="userix" UNIQUE="false" FIELDS="userid"/>
                <INDEX NAME="ipix" UNIQUE="false" FIELDS="ip"/>
            </INDEXES>
        </TABLE>
        <TABLE NAME="tool_bruteforce_block" COMMENT="Active blocks for users or IPs">
            <FIELDS>
                <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
                <FIELD NAME="type" TYPE="char" LENGTH="10" NOTNULL="true" COMMENT="user or ip"/>
                <FIELD NAME="value" TYPE="char" LENGTH="100" NOTNULL="true" COMMENT="userid or ip"/>
                <FIELD NAME="reason" TYPE="text" NOTNULL="false"/>
                <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true"/>
                <FIELD NAME="timerelease" TYPE="int" LENGTH="10" NOTNULL="true"/>
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
                <KEY NAME="typevalue" TYPE="unique" FIELDS="type,value"/>
            </KEYS>
        </TABLE>
        <TABLE NAME="tool_bruteforce_list" COMMENT="Whitelist or blacklist entries">
            <FIELDS>
                <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
                <FIELD NAME="listtype" TYPE="char" LENGTH="10" NOTNULL="true" COMMENT="white or black"/>
                <FIELD NAME="type" TYPE="char" LENGTH="10" NOTNULL="true" COMMENT="user or ip"/>
                <FIELD NAME="value" TYPE="char" LENGTH="100" NOTNULL="true"/>
                <FIELD NAME="comment" TYPE="text" NOTNULL="false"/>
                <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="false" COMMENT="who added"/>
                <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true"/>
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
                <KEY NAME="listuniq" TYPE="unique" FIELDS="listtype,type,value"/>
            </KEYS>
        </TABLE>
        <TABLE NAME="tool_bruteforce_audit" COMMENT="Administrative actions">
            <FIELDS>
                <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
                <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true"/>
                <FIELD NAME="action" TYPE="char" LENGTH="100" NOTNULL="true"/>
                <FIELD NAME="details" TYPE="text" NOTNULL="false"/>
                <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true"/>
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
            </KEYS>
        </TABLE>
    </TABLES>
</XMLDB>
