define(["jquery","core/config"],function(a,b){var c=function(a){var b,c,d=this,e=null,f=0;for(f=0;f<d.length;f++){if(b=d[f],c=a[f],"undefined"==typeof c){e=new Error("missing response");break}if(c.error!==!1){e=c.exception;break}b.deferred.resolve(c.data)}if(null!==e)for(;f<d.length;f++)b=d[f],b.deferred.reject(e)},d=function(a,b){var c=this,d=0;for(d=0;d<c.length;d++){var e=c[d];"undefined"!=typeof e.fail&&e.deferred.reject(b)}};return{call:function(e){var f,g=[],h=[];for(f=0;f<e.length;f++){var i=e[f];g.push({index:f,methodname:i.methodname,args:i.args}),i.deferred=a.Deferred(),h.push(i.deferred.promise()),"undefined"!=typeof i.done&&i.deferred.done(i.done),"undefined"!=typeof i.fail&&i.deferred.fail(i.fail),i.index=f}g=JSON.stringify(g);var j={type:"POST",data:g,context:e,dataType:"json",processData:!1};return a.ajax(b.wwwroot+"/lib/ajax/service.php",j).done(c).fail(d),h}}});