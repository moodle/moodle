YUI.add("moodle-atto_fullscreen-button",function(o,t){var r="fullscreen";o.namespace("M.atto_fullscreen").Button=o.Base.create("button",o.M.editor_atto.EditorPlugin,[],{initializer:function(){var t,e;this.get("enablebutton")&&(t=this.addButton({icon:"e/fullscreen",callback:this._toggle}),e=this.get("host"),t.set("title",M.util.get_string("pluginname","atto_fullscreen")),this._background=o.Node.create('<div style="position: relative"></div>'),e.on("pluginsloaded",function(t,e){this._setFullscreen(e),this.toolbar.after("click",o.bind(this._fitToScreen,this)),o.on("windowresize",o.bind(this._fitToScreen,this))},this,t),o.one("body").on("focus",function(t,e,i){!e.getData(!1)||i.editor.ancestor(".editor_atto_wrap").contains(t.target)||t.target.hasClass("moodle-dialogue")||t.target.ancestor(".moodle-dialogue")||t.target.one(".moodle-dialogue")||(this.unHighlightButtons(r),this._setFullscreen(e))},this,t,e))},disableButtons:function(){return this},_toggle:function(t){t.preventDefault();t=this.buttons[r];this.get("host").editor.focus(),t.getData(!1)?(this.unHighlightButtons(r),this._setFullscreen(t)):(this.highlightButtons(r),this._setFullscreen(t,!0))},_fitToScreen:function(){var t,e,i=this.buttons[r];i.getData(!1)&&(e=(i=this.get("host")).editor.hasAttribute("hidden")||"none"===i.editor.getComputedStyle("display"),this._background.setStyles({left:-i.editor.get("winWidth")/2,height:i.editor.get("winHeight"),width:i.editor.get("winWidth")}),window.scrollTo(this._background.getX(),this._background.getY()),i._wrapper.setStyles({maxWidth:"100%",width:"100%",top:0}),i.editor.show(),t=parseFloat(i.editor.getComputedStyle("height"))+i.editor.get("winHeight")-parseFloat(i._wrapper.getComputedStyle("height")),i.editor.setStyles({height:t,maxHeight:t}),t=parseFloat(t)+20,i.textarea.setStyles({padding:i.editor.getComputedStyle("padding"),margin:i.editor.getComputedStyle("margin"),width:i.editor.getComputedStyle("width"),height:t,maxHeight:t,top:i.editor.getY()-i.toolbar.getY()}),i.textarea.setStyle("margin-bottom",parseFloat(i.editor.getComputedStyle("margin-bottom"))+20),i.toolbar.ancestor().ancestor().all(".CodeMirror-wrap").setStyles({padding:i.textarea.getStyle("padding"),margin:i.textarea.getStyle("margin"),left:i.textarea.getStyle("left"),top:i.textarea.getStyle("top"),height:parseFloat(i.textarea.getStyle("height"))-20,maxHeight:parseFloat(i.textarea.getStyle("maxHeight"))-20,position:"fixed",width:i.textarea.getStyle("width")}),e&&(!i.textarea.hasAttribute("hidden")&&"none"!==i.textarea.getComputedStyle("display")||(this._background.setStyles({padding:i._wrapper.getComputedStyle("padding"),margin:i._wrapper.getComputedStyle("margin"),height:i._wrapper.getComputedStyle("height"),width:i._wrapper.getComputedStyle("width")}),window.scrollTo(this._background.getX(),this._background.getY())),this.editor.hide()))},_setFullscreen:function(t,e){var i=this.get("host");e?(o.one("body").setStyle("overflow","hidden"),this._editorStyle={minHeight:i.editor.getStyle("min-height"),height:i.editor.getStyle("height")},o.one("body").insertBefore(this._background,i._wrapper),i._wrapper.setStyles({position:"fixed",top:"0px",left:"0px",scroll:"auto"}),o.one("body").addClass("atto-fullscreen"),i.textarea.setStyles({position:"fixed",overflow:"auto",left:0}),i._wrapper.setStyles({left:0,position:"fixed"})):(o.one("body").setStyle("overflow","inherit"),this._background.remove(),this._editorStyle&&(i.editor.removeAttribute("style"),i.editor.setStyles(this._editorStyle),"none"===i.textarea.getComputedStyle("display")?(i.textarea.removeAttribute("style"),i.textarea.setStyle("display","none")):i.textarea.removeAttribute("style"),i.toolbar.ancestor().ancestor().all(".CodeMirror-wrap").removeAttribute("style").setStyles(this._editorStyle)),i._wrapper.removeAttribute("style"),o.one("body").removeClass("atto-fullscreen"),i.textarea.setStyle("width",this.toolbar.getComputedStyle("width"))),t.setData(!1,!!e),this._fitToScreen()}},{ATTRS:{enablebutton:{value:!1}}})},"@VERSION@",{requires:["event-resize","moodle-editor_atto-plugin"]});