define("tiny_cloze/cloze",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.strencode=_exports.strdecode=_exports.setStr=_exports.selectCustomPercent=_exports.queryClass=_exports.markerSpan=_exports.markerClass=_exports.isNull=_exports.isCustomGrade=_exports.indexOfNode=_exports.hasOddBracketCount=_exports.hasInvalidChars=_exports.hasClass=_exports.getUuid=_exports.getStr=_exports.getQuestionTypes=_exports.getFractionOptions=_exports.getCss=_exports.TEMPLATE=_exports.CSS=void 0;_exports.isNull=a=>null==a;_exports.strdecode=t=>String(t).replace(/\\(#|\}|~)/g,"$1");_exports.strencode=t=>String(t).replace(/(#|\}|~)/g,"\\$1");_exports.indexOfNode=(list,node)=>{for(let i=0;i<list.length;i++)if(list[i]===node)return i;return-1};_exports.hasInvalidChars=text=>{text=text.replace(/\\[.^$*+{}\\/]/g,"");for(const c of".^$*+{}\\/".split(""))if(text.indexOf(c)>-1)return!0;return!1};_exports.hasOddBracketCount=text=>{let stack=[];for(let i=0;i<text.length;i++){const char=text[i];if(!(i>0&&"\\"===text[i-1]))if("("===char||"["===char||"{"===char)stack.push(char);else if(")"===char||"]"===char||"}"===char){if(0===stack.length)return!0;let open=stack.pop();if("("===open&&")"!==char||"["===open&&"]"!==char||"{"===open&&"}"!==char)return!0}}return stack.length>0};_exports.getUuid=function(){return"undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID?crypto.randomUUID():"ed-cloze-"+Math.floor(1e5*Math.random()).toString().padStart(5,"0")};_exports.selectCustomPercent="__custom__";_exports.getFractionOptions=s=>{const attrSel=' selected="selected"';let isSel="="===s?attrSel:"",html='<option value="">'.concat(STR.incorrect,'</option><option value="="').concat(isSel,">").concat(STR.correct,"</option>");return FRACTIONS.forEach((item=>{isSel=item.value.toString()===s?attrSel:"",html+='<option value="'.concat(item.value,'"').concat(isSel,">").concat(item.value,"%</option>")})),isSel=""!==s&&-1===html.indexOf(attrSel)?attrSel:"",html+='<option value="'.concat("__custom__",'"').concat(isSel,">").concat(STR.custom_grade,"</option>"),html};_exports.isCustomGrade=s=>{if("="===s||""===s)return!1;let found=!1;return FRACTIONS.forEach((item=>{item.value.toString()===s&&(found=!0)})),!found};_exports.markerClass="cloze-question-marker";_exports.markerSpan='<span contenteditable="false" class="cloze-question-marker" data-mce-contenteditable="false">';const CSS={ANSWER:"tiny_cloze_answer",ANSWERS:"tiny_cloze_answers",ADD:"tiny_cloze_add",CANCEL:"tiny_cloze_cancel",DELETE:"tiny_cloze_delete",FEEDBACK:"tiny_cloze_feedback",FRACTION:"tiny_cloze_fraction",FRAC_CUSTOM:"tiny_cloze_frac_custom",LEFT:"tiny_cloze_col0",LOWER:"tiny_cloze_down",RIGHT:"tiny_cloze_col1",MARKS:"tiny_cloze_marks",DUPLICATE:"tiny_cloze_duplicate",RAISE:"tiny_cloze_up",SUBMIT:"tiny_cloze_submit",SUMMARY:"tiny_cloze_summary",TOLERANCE:"tiny_cloze_tolerance",TYPE:"tiny_cloze_qtype"};_exports.CSS=CSS;_exports.TEMPLATE={FORM:'<div class="tiny_cloze"><p>{{name}} ({{qtype}})</p><form name="tiny_cloze_form"><div class="ml-0 form-group"><label for="{{elementid}}_mark">{{STR.defaultmark}}</label><input id="{{elementid}}_mark" type="text" value="{{marks}}" class="{{CSS.MARKS}} form-control d-inline mx-2" /><a class="{{CSS.ADD}}" title="{{STR.addmoreanswerblanks}}"><img class="icon_smallicon" src="{{SRC.ADD}}" alt="{{STR.addmoreanswerblanks}}"></a></div><div class="msg-error hidden"></div><div class="{{CSS.ANSWERS}} mb-3"><ol class="pl-3">{{#answerdata}}<li class="mt-3"><div class="row form-group"><div class="col-2"><label for="{{id}}_answer">{{STR.answer}}</label></div><div class="col-8"><input id="{{id}}_answer" type="text" value="{{answer}}" class="{{CSS.ANSWER}} form-control d-inline mx-2" /></div><div class="col-2"><a class="{{CSS.ADD}}" title="{{STR.addmoreanswerblanks}}"><img class="icon_smallicon" src="{{SRC.ADD}}" alt="{{STR.addmoreanswerblanks}}"></a><a class="{{CSS.DELETE}}" title="{{STR.delete}}"><img class="icon_smallicon" src="{{SRC.DEL}}" alt="{{STR.delete}}"></a><a class="{{CSS.RAISE}}" title="{{STR.up}}"><img class="icon_smallicon" src="{{SRC.UP}}" alt="{{STR.up}}"></a><a class="{{CSS.LOWER}}" title="{{STR.down}}"><img class="icon_smallicon" src="{{SRC.DOWN}}" alt="{{STR.down}}"></a></div></div>{{#numerical}}<div class="row form-group"><div class="col-2"><label for="{{id}}_tolerance">{{{STR.tolerance}}}</label></div><div class="col-8"><input id="{{id}}_tolerance" type="text" value="{{tolerance}}" class="{{CSS.TOLERANCE}} form-control d-inline mx-2" /></div></div>{{/numerical}}<div class="row form-group"><div class="col-2"><label for="{{id}}_feedback">{{STR.feedback}}</label></div><div class="col-8"><input id="{{id}}_feedback" type="text" value="{{feedback}}" class="{{CSS.FEEDBACK}} form-control d-inline mx-2" /></div></div><div class="row form-group"><div class="col-2"><label id="{{id}}_grade">{{STR.grade}}</label></div><div class="col-8"><select id="{{id}}_grade" class="{{CSS.FRACTION}} custom-select mx-2">{{{fractionOptions}}}</select><span class="{{^isCustomGrade}} hidden{{/isCustomGrade}}"><input id="{{id}}_grade_custom" type="text"{{#isCustomGrade}} value="{{fraction}}"{{/isCustomGrade}} class="{{CSS.FRAC_CUSTOM}} form-control d-inline mx-2" style="width: 4rem;" />%</span></div></div></li>{{/answerdata}}</ol></div></form></div>',TYPE:'<div class="tiny_cloze mt-0 mx-2 mb-2"><p>{{STR.chooseqtypetoadd}}</p><form name="tiny_cloze_form"><div class="{{CSS.TYPE}} form-check">{{#types}}<div class="option"><input name="qtype" id="qtype_qtype_{{type}}" value="{{type}}" type="radio" class="form-check-input"><label for="qtype_qtype_{{type}}"><span class="typename">{{type}}</span><span class="{{CSS.SUMMARY}}"><h6>{{name}}</h6><p>{{summary}}</p><ul>{{#options}}<li>{{.}}</li>{{/options}}</ul></span></label></div>{{/types}}</div></form></div>',FOOTER:'<button type="button" class="btn btn-secondary" data-action="cancel">{{cancel}}</button><button type="button" class="btn btn-primary" data-action="save">{{submit}}</button>'};const FRACTIONS=[{value:100},{value:50},{value:0}],STR={};_exports.getQuestionTypes=function(withMultianswerrgx){let qtypes=[{type:"MULTICHOICE",abbr:["MC"],name:STR.multichoice,summary:STR.summary_multichoice,options:[STR.selectinline,STR.singleyes]},{type:"MULTICHOICE_H",abbr:["MCH"],name:STR.multichoice,summary:STR.summary_multichoice,options:[STR.horizontal,STR.singleyes]},{type:"MULTICHOICE_V",abbr:["MCV"],name:STR.multichoice,summary:STR.summary_multichoice,options:[STR.vertical,STR.singleyes]},{type:"MULTICHOICE_S",abbr:["MCS"],name:STR.multichoice,summary:STR.summary_multichoice,options:[STR.selectinline,STR.shuffle,STR.singleyes]},{type:"MULTICHOICE_HS",abbr:["MCHS"],name:STR.multichoice,summary:STR.summary_multichoice,options:[STR.horizontal,STR.shuffle,STR.singleyes]},{type:"MULTICHOICE_VS",abbr:["MCVS"],name:STR.multichoice,summary:STR.summary_multichoice,options:[STR.vertical,STR.shuffle,STR.singleyes]},{type:"MULTIRESPONSE",abbr:["MR"],name:STR.multiresponse,summary:STR.summary_multichoice,options:[STR.multi_vertical,STR.singleno]},{type:"MULTIRESPONSE_H",abbr:["MRH"],name:STR.multiresponse,summary:STR.summary_multichoice,options:[STR.multi_horizontal,STR.singleno]},{type:"MULTIRESPONSE_S",abbr:["MRS"],name:STR.multiresponse,summary:STR.summary_multichoice,options:[STR.multi_vertical,STR.shuffle,STR.singleno]},{type:"MULTIRESPONSE_HS",abbr:["MRHS"],name:STR.multiresponse,summary:STR.summary_multichoice,options:[STR.multi_horizontal,STR.shuffle,STR.singleno]},{type:"NUMERICAL",abbr:["NM"],name:STR.numerical,summary:STR.summary_numerical},{type:"SHORTANSWER",abbr:["SA","MW"],name:STR.shortanswer,summary:STR.summary_shortanswer,options:[STR.caseno]},{type:"SHORTANSWER_C",abbr:["SAC","MWC"],name:STR.shortanswer,summary:STR.summary_shortanswer,options:[STR.caseyes]}];return withMultianswerrgx&&qtypes.splice(11,0,{type:"REGEXP",abbr:["RX"],name:STR.regexp,summary:STR.summary_regexp,options:[STR.caseno]},{type:"REGEXP_C",abbr:["RXC"],name:STR.regexp,summary:STR.summary_regexp,options:[STR.caseyes]}),qtypes};_exports.getCss=function(){return CSS};_exports.hasClass=function(node,className){return node.classList.contains(CSS[className])};_exports.queryClass=function(className){return".".concat(CSS[className])};_exports.setStr=function(key,val){STR[key]=val};_exports.getStr=function(key){var _STR$key;return"*"===key?STR:null!==(_STR$key=STR[key])&&void 0!==_STR$key?_STR$key:key}}));

//# sourceMappingURL=cloze.min.js.map