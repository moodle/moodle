/*
Copyright (c) 2010, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 3.1.0
build: 2026
*/
YUI.add("tabview",function(B){var C=B.ClassNameManager.getClassName,G="tabview",M="tab",O="content",L="panel",I="selected",J={},K=".",E={tabview:C(G),tabviewPanel:C(G,L),tabviewList:C(G,"list"),tab:C(M),tabLabel:C(M,"label"),tabPanel:C(M,L),selectedTab:C(M,I),selectedPanel:C(M,L,I)},F={tabview:K+E.tabview,tabviewList:"> ul",tab:"> ul > li",tabLabel:"> ul > li > a ",tabviewPanel:"> div",tabPanel:"> div > div",selectedTab:"> ul > "+K+E.selectedTab,selectedPanel:"> div "+K+E.selectedPanel},A=function(P){this.init.apply(this,arguments);};A.NAME="tabviewBase";A._queries=F;A._classNames=E;B.mix(A.prototype,{init:function(P){P=P||J;this._node=P.host||B.one(P.node);this.refresh();},initClassNames:function(P){B.Object.each(F,function(S,R){if(E[R]){var Q=this.all(S);if(P!==undefined){Q=Q.item(P);}if(Q){Q.addClass(E[R]);}}},this._node);this._node.addClass(E.tabview);},_select:function(Q){var T=this._node,U=T.one(F.selectedTab),S=T.one(F.selectedPanel),R=T.all(F.tab).item(Q),P=T.all(F.tabPanel).item(Q);if(U){U.removeClass(E.selectedTab);}if(S){S.removeClass(E.selectedPanel);}if(R){R.addClass(E.selectedTab);}if(P){P.addClass(E.selectedPanel);}},initState:function(){var Q=this._node,R=Q.one(F.selectedTab),P=R?Q.all(F.tab).indexOf(R):0;this._select(P);},_scrubTextNodes:function(){this._node.one(F.tabviewList).get("childNodes").each(function(P){if(P.get("nodeType")===3){P.remove();}});},refresh:function(){this._scrubTextNodes();this.initClassNames();this.initState();this.initEvents();},tabEventName:"click",initEvents:function(){this._node.delegate(this.tabEventName,this.onTabEvent,F.tab,this);},onTabEvent:function(P){P.preventDefault();this._select(this._node.all(F.tab).indexOf(P.currentTarget));},destroy:function(){this._node.detach(this.tabEventName);}});B.TabviewBase=A;var F=B.TabviewBase._queries,E=B.TabviewBase._classNames,K=".",D=((B.UA.gecko||B.UA.ie)&&navigator.userAgent.indexOf("Windows")>-1),C=B.ClassNameManager.getClassName,N=B.Base.create("tabView",B.Widget,[B.WidgetParent],{_afterChildAdded:function(P){this.get("contentBox").focusManager.refresh();},_afterChildRemoved:function(R){var P=R.index,Q=this.get("selection");if(!Q){Q=this.item(P-1)||this.item(0);if(Q){Q.set("selected",1);}}this.get("contentBox").focusManager.refresh();},_initAria:function(){var P=this.get("contentBox"),Q=P.one(F.tabviewList);if(Q){Q.setAttrs({role:Q});}if(D){tabView.delegate("keydown",function(R){if(R.charCode===13){this.simulate("click");}},">ul>li>a");}},bindUI:function(){this.get("contentBox").plug(B.Plugin.NodeFocusManager,{descendants:K+E.tabLabel,keys:{next:"down:39",previous:"down:37"},circular:true});this.after("addChild",this._afterChildAdded);this.after("removeChild",this._afterChildRemoved);},renderUI:function(){var P=this.get("contentBox");this._renderListBox(P);this._renderPanelBox(P);this._renderTabs(P);this._setDefSelection(P);},_setDefSelection:function(){var P=this.item(0);if(!this.get("selection")&&P){P.set("selected",1);}},_renderListBox:function(P){var Q=P.one(F.tabviewList);if(!Q){Q=P.appendChild(B.Node.create(N.LIST_TEMPLATE));}else{Q.addClass(E.tabviewList);}this._childrenContainer=Q;},_renderPanelBox:function(Q){var P=Q.one(F.tabviewPanel);if(!P){Q.append(N.PANEL_TEMPLATE);}else{P.addClass(E.tabviewPanel);}},_renderTabs:function(P){var R=P.all(F.tab),Q=P.all(F.tabPanel),S=this;if(R){R.addClass(E.tab);P.all(F.tabLabel).addClass(E.tabLabel);P.all(F.tabPanel).addClass(E.tabPanel);R.each(function(V,U){var T=Q.item(U);S.add({boundingBox:V,contentBox:V.one(K+E.tabLabel),label:V.one(K+E.tabLabel).get("text"),content:T?T.get("innerHTML"):null});});}}},{LIST_TEMPLATE:'<ul class="'+E.tabviewList+'"></ul>',PANEL_TEMPLATE:'<div class="'+E.tabviewPanel+'"></div>',ATTRS:{defaultChildType:{value:"Tab"},tabIndex:{value:null}}});B.TabView=N;var H=B.Lang,F=B.TabviewBase._queries,E=B.TabviewBase._classNames,D=((B.UA.gecko||B.UA.ie)&&navigator.userAgent.indexOf("Windows")>-1),C=B.ClassNameManager.getClassName;B.Tab=B.Base.create("tab",B.Widget,[B.WidgetChild],{BOUNDING_TEMPLATE:'<li class="'+E.tab+'"></li>',CONTENT_TEMPLATE:'<a class="'+E.tabLabel+'"></a>',PANEL_TEMPLATE:'<div class="'+E.tabPanel+'"></div>',_uiSetSelectedPanel:function(P){this.get("panelNode").toggleClass(E.selectedPanel,P);},_afterTabSelectedChange:function(P){this._uiSetSelectedPanel(P.newVal);},_afterParentChange:function(P){if(!P.newVal){this._remove();}else{this._add();}},_initAria:function(){var Q=this.get("contentBox"),R=Q.get("id"),P=this.get("panelNode");if(!R){R=B.guid();Q.set("id",R);}Q.set("role","tab");Q.get("parentNode").set("role","presentation");if(D){Q.removeAttribute("href");}P.setAttrs({role:"tabpanel","aria-labelledby":R});},syncUI:function(){this.set("label",this.get("label"));this.set("content",this.get("content"));this._uiSetSelectedPanel(this.get("selected"));},bindUI:function(){this.after("selectedChange",this._afterTabSelectedChange);this.after("parentChange",this._afterParentChange);},renderUI:function(){this._renderPanel();this._initAria();},_renderPanel:function(){this.get("parent").get("contentBox").one(F.tabviewPanel).appendChild(this.get("panelNode"));},_add:function(){var P=this.get("parent").get("contentBox"),R=P.one(F.tabviewList),Q=P.one(F.tabviewPanel);if(R){R.appendChild(this.get("boundingBox"));}if(Q){Q.appendChild(this.get("panelNode"));}},_remove:function(){this.get("boundingBox").remove();this.get("panelNode").remove();},_onActivate:function(P){if(P.target===this){P.domEvent.preventDefault();P.target.set("selected",1);}},initializer:function(){this.publish(this.get("triggerEvent"),{defaultFn:this._onActivate});},_defLabelSetter:function(P){this.get("contentBox").setContent(P);return P;},_defContentSetter:function(P){this.get("panelNode").setContent(P);return P;},_defPanelNodeValueFn:function(){var R,Q=this.get("contentBox").get("href")||"",P;if(Q.charAt(0)==="#"){R=Q.substr(1);P=B.one(Q);}else{R=B.guid();}if(!P){P=B.Node.create(this.PANEL_TEMPLATE);P.set("id",R);}return P;}},{ATTRS:{triggerEvent:{value:"click"},label:{setter:"_defLabelSetter",validator:H.isString},content:{setter:"_defContentSetter",validator:H.isString},panelNode:{valueFn:"_defPanelNodeValueFn"},tabIndex:{value:null,validator:"_validTabIndex"}},HTML_PARSER:{selected:function(P){return this.get("boundingBox").hasClass(E.selectedTab);
}}});},"3.1.0",{requires:["substitute","node-focusmanager","tabview-base","widget","widget-parent","widget-child"]});