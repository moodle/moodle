{"version":3,"file":"dialoguedom.min.js","sources":["../../../src/local/activitychooser/dialoguedom.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\nimport {addIconToContainer} from 'core/loadingicon';\r\nimport Carousel from 'theme_boost/bootstrap/carousel';\r\nimport {getFirst} from 'core/normalise';\r\nimport Notification from 'core/notification';\r\nimport Pending from 'core/pending';\r\nimport selectors from 'core_courseformat/local/activitychooser/selectors';\r\nimport Tab from 'theme_boost/bootstrap/tab';\r\nimport * as Templates from 'core/templates';\r\n\r\n\r\n/**\r\n * The activity changer dialogue DOM manipulation module.\r\n *\r\n * @module     core_courseformat/local/activitychooser/dialoguedom\r\n * @copyright  2025 Ferran Recio <ferran@moodle.com>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\nexport default class ChooserDialogueDOM {\r\n    /**\r\n     * ChooserDialogueDOM constructor.\r\n     *\r\n     * @param {Object} dialogue The dialogue object.\r\n     * @param {Modal} modal The modal object.\r\n     * @param {Object} exporter The exporter object to generate template data.\r\n     */\r\n    constructor(dialogue, modal, exporter) {\r\n        this.modal = modal;\r\n        this.modalBody = getFirst(this.modal.getBody());\r\n        this.exporter = exporter;\r\n        // Temporal variable while migrating methods.\r\n        this.dialogue = dialogue;\r\n    }\r\n\r\n    /**\r\n     * Get the search input element.\r\n     *\r\n     * @return {HTMLElement} The search input element.\r\n     */\r\n    getSearchInputElement() {\r\n        return this.modalBody.querySelector(selectors.actions.search);\r\n    }\r\n\r\n    /**\r\n     * Get the closest chooser option element.\r\n     *\r\n     * @param {HTMLElement} element\r\n     * @return {HTMLElement|null} element\r\n     */\r\n    getClosestChooserOption(element) {\r\n        return element.closest(selectors.regions.chooserOption.container);\r\n    }\r\n\r\n    /**\r\n     * Check if the search tab is active.\r\n     *\r\n     * @return {Boolean} True if the search tab is active, false otherwise.\r\n     */\r\n    isFavoutiteTabActive() {\r\n        const favouriteTab = this.modalBody.querySelector(selectors.regions.favouriteTabNav);\r\n        return favouriteTab && favouriteTab.classList.contains('active');\r\n    }\r\n\r\n    /**\r\n     * Get the URL of a chooser option.\r\n     *\r\n     * @param {HTMLElement} optionContainer The container of the chooser option.\r\n     * @return {String} The URL of the chooser option.\r\n     * @throws {Error} If the option container does not contain a link.\r\n     */\r\n    getChooserOptionUrl(optionContainer) {\r\n        const optionLink = optionContainer.querySelector(selectors.actions.addChooser);\r\n        if (!optionLink) {\r\n            throw new Error('Invalid chooser option container: no link found');\r\n        }\r\n        return optionLink.getAttribute('href');\r\n    }\r\n\r\n    /**\r\n     * Show the search results.\r\n     *\r\n     * @param {String} searchQuery The search query string.\r\n     * @param {Object} searchResultsData Data containing the module items that satisfy the search criteria\r\n     */\r\n    async refreshSearchResults(searchQuery, searchResultsData) {\r\n        const searchResultsContainer = this.modalBody.querySelector(selectors.regions.searchResults);\r\n        const clearSearchButton = this.modalBody.querySelector(selectors.actions.clearSearch);\r\n\r\n        await this.renderSearchResults(searchResultsContainer, searchQuery, searchResultsData);\r\n        const chooserOptionsContainer = searchResultsContainer.querySelector(selectors.regions.chooserOptions);\r\n        const firstSearchResultItem = chooserOptionsContainer.querySelector(selectors.regions.chooserOption.container);\r\n        if (firstSearchResultItem) {\r\n            // Set the first result item to be focusable.\r\n            this.toggleFocusableChooserOption(firstSearchResultItem, true);\r\n            // Register keyboard events on the created search result items.\r\n        }\r\n        clearSearchButton.classList.remove('d-none');\r\n\r\n        // Results are rendered in the all activities tab, so we need to hide the category content.\r\n        const tabContent = searchResultsContainer.closest(selectors.regions.tabContent);\r\n        const categoryContent = tabContent.querySelector(selectors.regions.categoryContent);\r\n        categoryContent.classList.add('d-none');\r\n    }\r\n\r\n    /**\r\n     * Clear the search results.\r\n     */\r\n    cleanSearchResults() {\r\n        const searchResultsContainer = this.modalBody.querySelector(selectors.regions.searchResults);\r\n        const clearSearchButton = this.modalBody.querySelector(selectors.actions.clearSearch);\r\n        searchResultsContainer.innerHTML = '';\r\n        clearSearchButton.classList.add('d-none');\r\n\r\n        // Results are rendered in the all activities tab, so we need to show the category content again.\r\n        const tabContent = searchResultsContainer.closest(selectors.regions.tabContent);\r\n        const categoryContent = tabContent.querySelector(selectors.regions.categoryContent);\r\n        categoryContent.classList.remove('d-none');\r\n    }\r\n\r\n    /**\r\n     * Render the search results in a defined container\r\n     *\r\n     * @private\r\n     * @method renderSearchResults\r\n     * @param {HTMLElement} searchResultsContainer The container where the data should be rendered\r\n     * @param {String} searchQuery The search query string\r\n     * @param {Object} searchResultsData Data containing the module items that satisfy the search criteria\r\n     */\r\n    async renderSearchResults(searchResultsContainer, searchQuery, searchResultsData) {\r\n        const templateData = this.exporter.getSearchResultData(searchQuery, searchResultsData);\r\n        // Build up the html & js ready to place into the help section.\r\n        const {html, js} = await Templates.renderForPromise(\r\n            'core_courseformat/local/activitychooser/search_results',\r\n            templateData\r\n        );\r\n        await Templates.replaceNodeContents(searchResultsContainer, html, js);\r\n    }\r\n\r\n    /**\r\n     * Show the \"All activities\" tab.\r\n     *\r\n     * @method showAllActivitiesTab\r\n     * @return {HTMLElement} The \"All activities\" tab element.\r\n     */\r\n    showAllActivitiesTab() {\r\n        return this.showCategoryTab('all');\r\n    }\r\n\r\n    /**\r\n     * Show a specific category tab.\r\n     * @method showCategoryTab\r\n     * @param {String} category The category to show.\r\n     * @return {HTMLElement} The category tab element.\r\n     */\r\n    showCategoryTab(category) {\r\n        const navTab = this.modalBody.querySelector(selectors.regions.categoryTabNav(category));\r\n\r\n        if (navTab.classList.contains('active')) {\r\n            return navTab;\r\n        }\r\n\r\n        const pendingPromise = new Pending(`core_courseformat/activitychooser:${category}-tab`);\r\n\r\n        navTab.addEventListener('shown.bs.tab', pendingPromise.resolve, {once: true});\r\n        Tab.getOrCreateInstance(navTab).show();\r\n\r\n        return navTab;\r\n    }\r\n\r\n    /**\r\n     * Update the starred icons in the chooser modal.\r\n     *\r\n     * @method updateItemStarredIcons\r\n     * @param {String} internal The internal name of the module.\r\n     * @param {Boolean} favourite Whether the module is a favourite or not.\r\n     */\r\n    updateItemStarredIcons(internal, favourite) {\r\n        const favouriteButtons = this.modalBody.querySelectorAll(\r\n            `${selectors.elements.moduleItem(internal)} ${selectors.actions.optionActions.manageFavourite}`\r\n        );\r\n        Array.from(favouriteButtons).forEach((element) => {\r\n            element.dataset.favourited = favourite;\r\n            element.setAttribute('aria-pressed', favourite);\r\n            element.querySelector(selectors.elements.favouriteIconActive)?.classList.toggle('d-none', !favourite);\r\n            element.querySelector(selectors.elements.favouriteIconInactive)?.classList.toggle('d-none', favourite);\r\n\r\n            const iconSelectsor = favourite ? selectors.elements.favouriteIconActive : selectors.elements.favouriteIconInactive;\r\n            const favouriteIcon = element.querySelector(iconSelectsor);\r\n            element.setAttribute('aria-label', favouriteIcon?.getAttribute('data-action-label') || '');\r\n            element.setAttribute('title', favouriteIcon?.getAttribute('data-action-label') || '');\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Refresh the favourite content.\r\n     *\r\n     * @param {Array} mappedModules The modules to be displayed in the favourite tab.\r\n     */\r\n    async refreshFavouritesTabContent(mappedModules) {\r\n        const templateData = await this.exporter.getFavouriteTabData(mappedModules);\r\n        const favouriteArea = this.modalBody.querySelector(selectors.regions.favouriteTab);\r\n        const {html, js} = await Templates.renderForPromise(\r\n            'core_courseformat/local/activitychooser/tabcontent',\r\n            templateData,\r\n        );\r\n        await Templates.replaceNodeContents(favouriteArea, html, js);\r\n    }\r\n\r\n    /**\r\n     * Toggle the display of the favourite tab.\r\n     *\r\n     * The favourite tab is only displayed when there are favourite modules\r\n     * or when it is the active tab.\r\n     *\r\n     * @param {Boolean} displayed Whether we want to show or hide the favourite tab\r\n     */\r\n    toggleFavouriteTabDisplay(displayed) {\r\n        const favouriteTabNav = this.modalBody.querySelector(selectors.regions.favouriteTabNav);\r\n\r\n        let moveFocusTo;\r\n        if (!displayed && favouriteTabNav.classList.contains('active')) {\r\n            moveFocusTo = this.showAllActivitiesTab();\r\n        }\r\n\r\n        favouriteTabNav?.classList.toggle('d-none', !displayed);\r\n        favouriteTabNav.tabIndex = displayed ? 0 : -1;\r\n        // The disabled class is used by Boostrap Tab for keyboard navigation.\r\n        if (displayed) {\r\n            favouriteTabNav.classList.remove('disabled');\r\n        } else {\r\n            favouriteTabNav.classList.add('disabled');\r\n        }\r\n\r\n        if (moveFocusTo) {\r\n            moveFocusTo.focus();\r\n        }\r\n        this.initActiveTabNavigation();\r\n    }\r\n\r\n    /**\r\n     * Given an event from the main module 'page' navigate to it's help section via a carousel.\r\n     *\r\n     * @method showModuleHelp\r\n     * @param {Object} moduleData Data of the module to carousel to\r\n     */\r\n    async showModuleHelp(moduleData) {\r\n        const carousel = this.modalBody.querySelector(selectors.regions.carousel);\r\n\r\n        const help = carousel.querySelector(selectors.regions.help);\r\n        help.innerHTML = '';\r\n        help.classList.add('m-auto');\r\n\r\n        // Add a spinner.\r\n        const spinnerPromise = addIconToContainer(help);\r\n\r\n        // Used later...\r\n        let transitionPromiseResolver = null;\r\n        const transitionPromise = new Promise(resolve => {\r\n            transitionPromiseResolver = resolve;\r\n        });\r\n\r\n        // Build up the html & js ready to place into the help section.\r\n        const contentPromise = Templates.renderForPromise(\r\n            'core_courseformat/local/activitychooser/help',\r\n            await this.exporter.getModuleHelpTemplateData(moduleData),\r\n        );\r\n\r\n        // Wait for the content to be ready, and for the transition to be complet.\r\n        Promise.all([contentPromise, spinnerPromise, transitionPromise])\r\n            .then(([{html, js}]) => Templates.replaceNodeContents(help, html, js))\r\n            .then(() => {\r\n                help.querySelector(selectors.regions.chooserSummary.header).focus();\r\n                return help;\r\n            })\r\n            .catch(Notification.exception);\r\n\r\n        // Move to the next slide, and resolve the transition promise when it's done.\r\n        carousel.addEventListener(\r\n            'slid.bs.carousel',\r\n            () => {\r\n                transitionPromiseResolver();\r\n            },\r\n            {once: true}\r\n        );\r\n        // Trigger the transition between 'pages'.\r\n        Carousel.getInstance(carousel).next();\r\n    }\r\n\r\n    /**\r\n     * Hide the help section of the chooser.\r\n     *\r\n     * @param {String|null} internal The internal name of the module to return to, if any.\r\n     */\r\n    hideModuleHelp(internal = null) {\r\n        const carousel = this.modalBody.querySelector(selectors.regions.carousel);\r\n        // Trigger the transition between 'pages'.\r\n        Carousel.getInstance(carousel).to(0);\r\n        // Some active footers may not provide a valid internal value.\r\n        if (!internal) {\r\n            return;\r\n        }\r\n        carousel.addEventListener(\r\n            'slid.bs.carousel',\r\n            () => {\r\n                this.focusChooserOption(internal);\r\n            },\r\n            {once: true}\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Set the module data for the back button.\r\n     *\r\n     * @param {Object} moduleData The module data to set for the back button.\r\n     */\r\n    setBackButtonModuleData(moduleData) {\r\n        const footer = getFirst(this.modal.getFooter());\r\n        const modnameValue = `${moduleData.componentname}_${moduleData.link}`;\r\n        footer.querySelector(selectors.actions.closeOption).dataset.modname = modnameValue;\r\n    }\r\n\r\n    /**\r\n     * Toggle the visibility of the back button.\r\n     *\r\n     * @param {Boolean} show Whether to show or hide the back button.\r\n     */\r\n    toggleBackButton(show) {\r\n        const footer = getFirst(this.modal.getFooter());\r\n        footer.querySelector(selectors.actions.closeOption).classList.toggle('d-none', !show);\r\n    }\r\n\r\n    /**\r\n     * Toggle the visibility of the \"Add selected\" button.\r\n     *\r\n     * @param {Boolean} show Whether to show or hide the \"Add selected\" button.\r\n     */\r\n    toggleAddButton(show) {\r\n        const footer = getFirst(this.modal.getFooter());\r\n        footer.querySelector(selectors.actions.addSelectedChooserOption).classList.toggle('d-none', !show);\r\n    }\r\n\r\n    /**\r\n     * Toggle the visibility of the active footer.\r\n     *\r\n     * @param {Boolean} show Whether to show or hide the active footer.\r\n     */\r\n    toggleActiveFooter(show) {\r\n        const footer = getFirst(this.modal.getFooter());\r\n        footer.querySelector(selectors.regions.activeFooter).classList.toggle('d-none', !show);\r\n    }\r\n\r\n    /**\r\n     * Focus on a specific activity inside the active tab (if present).\r\n     *\r\n     * @private\r\n     * @method focusChooserOption\r\n     * @param {String} internal The internal name of the module.\r\n     */\r\n    focusChooserOption(internal) {\r\n        const currentTabNav = this.modalBody.querySelector(selectors.elements.activetab);\r\n        const activeSectionId = currentTabNav.getAttribute(\"href\");\r\n        const sectionChooserOptions = this.modalBody.querySelector(selectors.regions.getSectionChooserOptions(activeSectionId));\r\n        const newCurrent = sectionChooserOptions.querySelector(selectors.regions.getModuleSelector(internal));\r\n\r\n        if (!newCurrent) {\r\n            throw new Error(`Invalid chooser option to focus on: ${internal}`);\r\n        }\r\n\r\n        // Chooser can only have one element focusable at a time, so we disable them all first.\r\n        this.disableFocusAllChooserOptions(currentTabNav);\r\n        this.toggleFocusableChooserOption(newCurrent, true);\r\n\r\n        // Little hack: we want the element considered a focus-visible element.\r\n        // But the focus method does not trigger the focus-visible class. There's an\r\n        // experimental \"{focusVisible: true}\" option in the focus method, but it's not\r\n        // supported in all browsers yet so we need to fake an editable element.\r\n        newCurrent.contentEditable = true;\r\n        newCurrent.focus();\r\n        newCurrent.contentEditable = false;\r\n    }\r\n\r\n    /**\r\n     * Initialise the active tab navigation.\r\n     */\r\n    initActiveTabNavigation() {\r\n        const activeSectionId = this.modalBody.querySelector(selectors.elements.activetab).getAttribute(\"href\");\r\n        const sectionChooserOptions = this.modalBody.querySelector(selectors.regions.getSectionChooserOptions(activeSectionId));\r\n        const firstChooserOption = sectionChooserOptions?.querySelector(selectors.regions.chooserOption.container);\r\n        if (!firstChooserOption) {\r\n            return;\r\n        }\r\n        this.toggleFocusableChooserOption(firstChooserOption, true);\r\n    }\r\n\r\n    /**\r\n     * Initialise all Boostrap components.\r\n     */\r\n    initBootstrapComponents() {\r\n        this.modalBody.querySelectorAll(selectors.elements.tab).forEach((navTab) => {\r\n            // Init the Bootstrap Tab navigation.\r\n            Tab.getOrCreateInstance(navTab);\r\n        });\r\n\r\n        // Set up the carousel.\r\n        const carousel = this.modalBody.querySelector(selectors.regions.carousel);\r\n        new Carousel(carousel, {\r\n            interval: false,\r\n            pause: true,\r\n            keyboard: false\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Disable the focus of all chooser options in a specific container (section).\r\n     *\r\n     * @method disableFocusAllChooserOptions\r\n     * @param {HTMLElement} tabNav The tab navigation element (from the shown.bs.ta event).\r\n     */\r\n    disableFocusAllChooserOptions(tabNav) {\r\n        const tabId = tabNav.getAttribute(\"href\");\r\n        const chooserOptions = this.modalBody.querySelector(\r\n            selectors.regions.getSectionChooserOptions(tabId)\r\n        );\r\n\r\n        if (chooserOptions === null) {\r\n            return;\r\n        }\r\n\r\n        const allChooserOptions = chooserOptions.querySelectorAll(selectors.regions.chooserOption.container);\r\n        allChooserOptions.forEach((chooserOption) => {\r\n            this.toggleFocusableChooserOption(chooserOption, false);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Add or remove a chooser option from the focus order.\r\n     *\r\n     * @private\r\n     * @method toggleFocusableChooserOption\r\n     * @param {HTMLElement} chooserOption The chooser option element which should be added or removed from the focus order\r\n     * @param {Boolean} isFocusable Whether the chooser element is focusable or not\r\n     */\r\n    toggleFocusableChooserOption(chooserOption, isFocusable) {\r\n        const chooserOptionLink = chooserOption.querySelector(selectors.actions.addChooser);\r\n        const chooserOptionHelp = chooserOption.querySelector(selectors.actions.optionActions.showSummary);\r\n        const chooserOptionFavourite = chooserOption.querySelector(selectors.actions.optionActions.manageFavourite);\r\n\r\n        if (isFocusable) {\r\n            // Set tabindex to 0 to add current chooser option element to the focus order.\r\n            chooserOption.tabIndex = 0;\r\n            chooserOptionLink.tabIndex = 0;\r\n            chooserOptionHelp.tabIndex = 0;\r\n            chooserOptionFavourite.tabIndex = 0;\r\n        } else {\r\n            // Set tabindex to -1 to remove the previous chooser option element from the focus order.\r\n            chooserOption.tabIndex = -1;\r\n            chooserOptionLink.tabIndex = -1;\r\n            chooserOptionHelp.tabIndex = -1;\r\n            chooserOptionFavourite.tabIndex = -1;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Move the focus to the previous chooser option element.\r\n     *\r\n     * @param {HTMLElement} current The current chooser option element\r\n     */\r\n    focusNextChooserOption(current) {\r\n        this.moveChooserOptionFocus(\r\n            current,\r\n            (currentOption) => currentOption.nextElementSibling ?? currentOption,\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Move the focus to the previous chooser option element.\r\n     *\r\n     * @param {HTMLElement} current The current chooser option element\r\n     */\r\n    focusPreviousChooserOption(current) {\r\n        this.moveChooserOptionFocus(\r\n            current,\r\n            (currentOption) => currentOption.previousElementSibling ?? currentOption,\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Move the focus to the first chooser option element.\r\n     *\r\n     * @param {HTMLElement} current The current chooser option element\r\n     */\r\n    focusFirstChooserOption(current) {\r\n        this.moveChooserOptionFocus(\r\n            current,\r\n            (currentOption, container) => container.firstElementChild ?? currentOption,\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Move the focus to the last chooser option element.\r\n     *\r\n     * @param {HTMLElement} current The current chooser option element\r\n     */\r\n    focusLastChooserOption(current) {\r\n        this.moveChooserOptionFocus(\r\n            current,\r\n            (currentOption, container) => container.lastElementChild ?? currentOption,\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Move the focus to the next chooser option element.\r\n     *\r\n     * @private\r\n     * @param {HTMLElement} current The current chooser option element\r\n     * @param {Function} getNextFocus Function to get the next focusable element\r\n     */\r\n    moveChooserOptionFocus(current, getNextFocus) {\r\n        const currentOption = this.getClosestChooserOption(current);\r\n        const container = current.closest(selectors.regions.chooserOptions);\r\n\r\n        if (!container || !currentOption) {\r\n            throw new Error('Invalid chooser options container or current option');\r\n        }\r\n\r\n        const newFocusOption = getNextFocus(currentOption, container);\r\n        if (!newFocusOption) {\r\n            return;\r\n        }\r\n\r\n        this.toggleFocusableChooserOption(currentOption, false);\r\n        this.toggleFocusableChooserOption(newFocusOption, true);\r\n        newFocusOption.focus();\r\n    }\r\n\r\n    /**\r\n     * Mark a chooser option as selected.\r\n     *\r\n     * @param {HTMLElement} chooserOption The chooser option element to mark as selected.\r\n     */\r\n    markChooserOptionAsSelected(chooserOption) {\r\n        this.unmarkAllChooserOptionAsSelected();\r\n        chooserOption.classList.add('selected');\r\n        chooserOption.setAttribute('aria-selected', 'true');\r\n\r\n        const footer = getFirst(this.modal.getFooter());\r\n        const addButton = footer.querySelector(selectors.actions.addSelectedChooserOption);\r\n        if (addButton) {\r\n            addButton.removeAttribute('disabled');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Unmark all chooser options as selected.\r\n     */\r\n    unmarkAllChooserOptionAsSelected() {\r\n        const selectedOptions = this.modalBody.querySelectorAll(`${selectors.regions.chooserOption.container}.selected`);\r\n        selectedOptions.forEach((option) => {\r\n            option.classList.remove('selected');\r\n            option.setAttribute('aria-selected', 'false');\r\n        });\r\n\r\n        const footer = getFirst(this.modal.getFooter());\r\n        const addButton = footer.querySelector(selectors.actions.addSelectedChooserOption);\r\n        if (addButton) {\r\n            addButton.setAttribute('disabled', 'disabled');\r\n        }\r\n    }\r\n}\r\n"],"names":["constructor","dialogue","modal","exporter","modalBody","this","getBody","getSearchInputElement","querySelector","selectors","actions","search","getClosestChooserOption","element","closest","regions","chooserOption","container","isFavoutiteTabActive","favouriteTab","favouriteTabNav","classList","contains","getChooserOptionUrl","optionContainer","optionLink","addChooser","Error","getAttribute","searchQuery","searchResultsData","searchResultsContainer","searchResults","clearSearchButton","clearSearch","renderSearchResults","firstSearchResultItem","chooserOptions","toggleFocusableChooserOption","remove","tabContent","categoryContent","add","cleanSearchResults","innerHTML","templateData","getSearchResultData","html","js","Templates","renderForPromise","replaceNodeContents","showAllActivitiesTab","showCategoryTab","category","navTab","categoryTabNav","pendingPromise","Pending","addEventListener","resolve","once","getOrCreateInstance","show","updateItemStarredIcons","internal","favourite","favouriteButtons","querySelectorAll","elements","moduleItem","optionActions","manageFavourite","Array","from","forEach","dataset","favourited","setAttribute","favouriteIconActive","toggle","favouriteIconInactive","iconSelectsor","favouriteIcon","mappedModules","getFavouriteTabData","favouriteArea","toggleFavouriteTabDisplay","displayed","moveFocusTo","tabIndex","focus","initActiveTabNavigation","moduleData","carousel","help","spinnerPromise","transitionPromiseResolver","transitionPromise","Promise","contentPromise","getModuleHelpTemplateData","all","then","_ref","chooserSummary","header","catch","Notification","exception","getInstance","next","hideModuleHelp","to","focusChooserOption","setBackButtonModuleData","footer","getFooter","modnameValue","componentname","link","closeOption","modname","toggleBackButton","toggleAddButton","addSelectedChooserOption","toggleActiveFooter","activeFooter","currentTabNav","activetab","activeSectionId","newCurrent","getSectionChooserOptions","getModuleSelector","disableFocusAllChooserOptions","contentEditable","sectionChooserOptions","firstChooserOption","initBootstrapComponents","tab","Carousel","interval","pause","keyboard","tabNav","tabId","isFocusable","chooserOptionLink","chooserOptionHelp","showSummary","chooserOptionFavourite","focusNextChooserOption","current","moveChooserOptionFocus","currentOption","nextElementSibling","focusPreviousChooserOption","previousElementSibling","focusFirstChooserOption","firstElementChild","focusLastChooserOption","lastElementChild","getNextFocus","newFocusOption","markChooserOptionAsSelected","unmarkAllChooserOptionAsSelected","addButton","removeAttribute","option"],"mappings":";;;;;;;++BAwCIA,YAAYC,SAAUC,MAAOC,eACpBD,MAAQA,WACRE,WAAY,uBAASC,KAAKH,MAAMI,gBAChCH,SAAWA,cAEXF,SAAWA,SAQpBM,+BACWF,KAAKD,UAAUI,cAAcC,mBAAUC,QAAQC,QAS1DC,wBAAwBC,gBACbA,QAAQC,QAAQL,mBAAUM,QAAQC,cAAcC,WAQ3DC,6BACUC,aAAed,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQK,wBAC7DD,cAAgBA,aAAaE,UAAUC,SAAS,UAU3DC,oBAAoBC,uBACVC,WAAaD,gBAAgBhB,cAAcC,mBAAUC,QAAQgB,gBAC9DD,iBACK,IAAIE,MAAM,0DAEbF,WAAWG,aAAa,mCASRC,YAAaC,yBAC9BC,uBAAyB1B,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQiB,eACxEC,kBAAoB5B,KAAKD,UAAUI,cAAcC,mBAAUC,QAAQwB,mBAEnE7B,KAAK8B,oBAAoBJ,uBAAwBF,YAAaC,yBAE9DM,sBAD0BL,uBAAuBvB,cAAcC,mBAAUM,QAAQsB,gBACjC7B,cAAcC,mBAAUM,QAAQC,cAAcC,WAChGmB,4BAEKE,6BAA6BF,uBAAuB,GAG7DH,kBAAkBZ,UAAUkB,OAAO,UAGhBR,uBAAuBjB,QAAQL,mBAAUM,QAAQyB,YACjChC,cAAcC,mBAAUM,QAAQ0B,iBACnDpB,UAAUqB,IAAI,UAMlCC,2BACUZ,uBAAyB1B,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQiB,eACxEC,kBAAoB5B,KAAKD,UAAUI,cAAcC,mBAAUC,QAAQwB,aACzEH,uBAAuBa,UAAY,GACnCX,kBAAkBZ,UAAUqB,IAAI,UAGbX,uBAAuBjB,QAAQL,mBAAUM,QAAQyB,YACjChC,cAAcC,mBAAUM,QAAQ0B,iBACnDpB,UAAUkB,OAAO,oCAYXR,uBAAwBF,YAAaC,yBACrDe,aAAexC,KAAKF,SAAS2C,oBAAoBjB,YAAaC,oBAE9DiB,KAACA,KAADC,GAAOA,UAAYC,UAAUC,iBAC/B,yDACAL,oBAEEI,UAAUE,oBAAoBpB,uBAAwBgB,KAAMC,IAStEI,8BACW/C,KAAKgD,gBAAgB,OAShCA,gBAAgBC,gBACNC,OAASlD,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQyC,eAAeF,cAEzEC,OAAOlC,UAAUC,SAAS,iBACnBiC,aAGLE,eAAiB,IAAIC,6DAA6CJ,yBAExEC,OAAOI,iBAAiB,eAAgBF,eAAeG,QAAS,CAACC,MAAM,iBACnEC,oBAAoBP,QAAQQ,OAEzBR,OAUXS,uBAAuBC,SAAUC,iBACvBC,iBAAmB9D,KAAKD,UAAUgE,2BACjC3D,mBAAU4D,SAASC,WAAWL,sBAAaxD,mBAAUC,QAAQ6D,cAAcC,kBAElFC,MAAMC,KAAKP,kBAAkBQ,SAAS9D,2DAClCA,QAAQ+D,QAAQC,WAAaX,UAC7BrD,QAAQiE,aAAa,eAAgBZ,yCACrCrD,QAAQL,cAAcC,mBAAU4D,SAASU,6EAAsB1D,UAAU2D,OAAO,UAAWd,0CAC3FrD,QAAQL,cAAcC,mBAAU4D,SAASY,iFAAwB5D,UAAU2D,OAAO,SAAUd,iBAEtFgB,cAAgBhB,UAAYzD,mBAAU4D,SAASU,oBAAsBtE,mBAAU4D,SAASY,sBACxFE,cAAgBtE,QAAQL,cAAc0E,eAC5CrE,QAAQiE,aAAa,cAAcK,MAAAA,qBAAAA,cAAevD,aAAa,uBAAwB,IACvFf,QAAQiE,aAAa,SAASK,MAAAA,qBAAAA,cAAevD,aAAa,uBAAwB,yCASxDwD,qBACxBvC,mBAAqBxC,KAAKF,SAASkF,oBAAoBD,eACvDE,cAAgBjF,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQI,eAC/D4B,KAACA,KAADC,GAAOA,UAAYC,UAAUC,iBAC/B,qDACAL,oBAEEI,UAAUE,oBAAoBmC,cAAevC,KAAMC,IAW7DuC,0BAA0BC,iBAChBpE,gBAAkBf,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQK,qBAEnEqE,aACCD,WAAapE,gBAAgBC,UAAUC,SAAS,YACjDmE,YAAcpF,KAAK+C,wBAGvBhC,MAAAA,iBAAAA,gBAAiBC,UAAU2D,OAAO,UAAWQ,WAC7CpE,gBAAgBsE,SAAWF,UAAY,GAAK,EAExCA,UACApE,gBAAgBC,UAAUkB,OAAO,YAEjCnB,gBAAgBC,UAAUqB,IAAI,YAG9B+C,aACAA,YAAYE,aAEXC,+CASYC,kBACXC,SAAWzF,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQ+E,UAE1DC,KAAOD,SAAStF,cAAcC,mBAAUM,QAAQgF,MACtDA,KAAKnD,UAAY,GACjBmD,KAAK1E,UAAUqB,IAAI,gBAGbsD,gBAAiB,mCAAmBD,UAGtCE,0BAA4B,WAC1BC,kBAAoB,IAAIC,SAAQvC,UAClCqC,0BAA4BrC,WAI1BwC,eAAiBnD,UAAUC,iBAC7B,qDACM7C,KAAKF,SAASkG,0BAA0BR,aAIlDM,QAAQG,IAAI,CAACF,eAAgBJ,eAAgBE,oBACxCK,MAAKC,YAAEzD,KAACA,KAADC,GAAOA,iBAASC,UAAUE,oBAAoB4C,KAAMhD,KAAMC,OACjEuD,MAAK,KACFR,KAAKvF,cAAcC,mBAAUM,QAAQ0F,eAAeC,QAAQf,QACrDI,QAEVY,MAAMC,sBAAaC,WAGxBf,SAASnC,iBACL,oBACA,KACIsC,8BAEJ,CAACpC,MAAM,sBAGFiD,YAAYhB,UAAUiB,OAQnCC,qBAAe/C,gEAAW,WAChB6B,SAAWzF,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQ+E,4BAEvDgB,YAAYhB,UAAUmB,GAAG,GAE7BhD,UAGL6B,SAASnC,iBACL,oBACA,UACSuD,mBAAmBjD,YAE5B,CAACJ,MAAM,IASfsD,wBAAwBtB,kBACduB,QAAS,uBAAS/G,KAAKH,MAAMmH,aAC7BC,uBAAkBzB,WAAW0B,0BAAiB1B,WAAW2B,MAC/DJ,OAAO5G,cAAcC,mBAAUC,QAAQ+G,aAAa7C,QAAQ8C,QAAUJ,aAQ1EK,iBAAiB5D,OACE,uBAAS1D,KAAKH,MAAMmH,aAC5B7G,cAAcC,mBAAUC,QAAQ+G,aAAapG,UAAU2D,OAAO,UAAWjB,MAQpF6D,gBAAgB7D,OACG,uBAAS1D,KAAKH,MAAMmH,aAC5B7G,cAAcC,mBAAUC,QAAQmH,0BAA0BxG,UAAU2D,OAAO,UAAWjB,MAQjG+D,mBAAmB/D,OACA,uBAAS1D,KAAKH,MAAMmH,aAC5B7G,cAAcC,mBAAUM,QAAQgH,cAAc1G,UAAU2D,OAAO,UAAWjB,MAUrFmD,mBAAmBjD,gBACT+D,cAAgB3H,KAAKD,UAAUI,cAAcC,mBAAU4D,SAAS4D,WAChEC,gBAAkBF,cAAcpG,aAAa,QAE7CuG,WADwB9H,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQqH,yBAAyBF,kBAC7D1H,cAAcC,mBAAUM,QAAQsH,kBAAkBpE,eAEtFkE,iBACK,IAAIxG,oDAA6CsC,gBAItDqE,8BAA8BN,oBAC9B1F,6BAA6B6F,YAAY,GAM9CA,WAAWI,iBAAkB,EAC7BJ,WAAWxC,QACXwC,WAAWI,iBAAkB,EAMjC3C,gCACUsC,gBAAkB7H,KAAKD,UAAUI,cAAcC,mBAAU4D,SAAS4D,WAAWrG,aAAa,QAC1F4G,sBAAwBnI,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQqH,yBAAyBF,kBAChGO,mBAAqBD,MAAAA,6BAAAA,sBAAuBhI,cAAcC,mBAAUM,QAAQC,cAAcC,WAC3FwH,yBAGAnG,6BAA6BmG,oBAAoB,GAM1DC,+BACStI,UAAUgE,iBAAiB3D,mBAAU4D,SAASsE,KAAKhE,SAASpB,sBAEzDO,oBAAoBP,iBAItBuC,SAAWzF,KAAKD,UAAUI,cAAcC,mBAAUM,QAAQ+E,cAC5D8C,kBAAS9C,SAAU,CACnB+C,UAAU,EACVC,OAAO,EACPC,UAAU,IAUlBT,8BAA8BU,cACpBC,MAAQD,OAAOpH,aAAa,QAC5BS,eAAiBhC,KAAKD,UAAUI,cAClCC,mBAAUM,QAAQqH,yBAAyBa,WAGxB,OAAnB5G,sBAIsBA,eAAe+B,iBAAiB3D,mBAAUM,QAAQC,cAAcC,WACxE0D,SAAS3D,qBAClBsB,6BAA6BtB,eAAe,MAYzDsB,6BAA6BtB,cAAekI,mBAClCC,kBAAoBnI,cAAcR,cAAcC,mBAAUC,QAAQgB,YAClE0H,kBAAoBpI,cAAcR,cAAcC,mBAAUC,QAAQ6D,cAAc8E,aAChFC,uBAAyBtI,cAAcR,cAAcC,mBAAUC,QAAQ6D,cAAcC,iBAEvF0E,aAEAlI,cAAc0E,SAAW,EACzByD,kBAAkBzD,SAAW,EAC7B0D,kBAAkB1D,SAAW,EAC7B4D,uBAAuB5D,SAAW,IAGlC1E,cAAc0E,UAAY,EAC1ByD,kBAAkBzD,UAAY,EAC9B0D,kBAAkB1D,UAAY,EAC9B4D,uBAAuB5D,UAAY,GAS3C6D,uBAAuBC,cACdC,uBACDD,SACCE,+EAAkBA,cAAcC,0EAAsBD,iBAS/DE,2BAA2BJ,cAClBC,uBACDD,SACCE,+EAAkBA,cAAcG,8EAA0BH,iBASnEI,wBAAwBN,cACfC,uBACDD,SACA,CAACE,cAAezI,4EAAcA,UAAU8I,yEAAqBL,iBASrEM,uBAAuBR,cACdC,uBACDD,SACA,CAACE,cAAezI,4EAAcA,UAAUgJ,wEAAoBP,iBAWpED,uBAAuBD,QAASU,oBACtBR,cAAgBrJ,KAAKO,wBAAwB4I,SAC7CvI,UAAYuI,QAAQ1I,QAAQL,mBAAUM,QAAQsB,oBAE/CpB,YAAcyI,oBACT,IAAI/H,MAAM,6DAGdwI,eAAiBD,aAAaR,cAAezI,WAC9CkJ,sBAIA7H,6BAA6BoH,eAAe,QAC5CpH,6BAA6B6H,gBAAgB,GAClDA,eAAexE,SAQnByE,4BAA4BpJ,oBACnBqJ,mCACLrJ,cAAcK,UAAUqB,IAAI,YAC5B1B,cAAc8D,aAAa,gBAAiB,cAGtCwF,WADS,uBAASjK,KAAKH,MAAMmH,aACV7G,cAAcC,mBAAUC,QAAQmH,0BACrDyC,WACAA,UAAUC,gBAAgB,YAOlCF,mCAC4BhK,KAAKD,UAAUgE,2BAAoB3D,mBAAUM,QAAQC,cAAcC,wBAC3E0D,SAAS6F,SACrBA,OAAOnJ,UAAUkB,OAAO,YACxBiI,OAAO1F,aAAa,gBAAiB,kBAInCwF,WADS,uBAASjK,KAAKH,MAAMmH,aACV7G,cAAcC,mBAAUC,QAAQmH,0BACrDyC,WACAA,UAAUxF,aAAa,WAAY"}