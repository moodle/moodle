{"version":3,"file":"darkmode.min.js","sources":["../src/darkmode.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Contain the logic for dark mode.\n *\n * @copyright  2020 Willian Mano - http://conecti.me\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/str', 'core/ajax'], function($, Str, Ajax) {\n\n    var SELECTORS = {\n        TRIGGER: '#toggle-darkmode-input',\n        MODECLASS: 'moove-darkmode'\n    };\n\n    var ISACTIVATED = false;\n\n    var DarkMode = function() {\n        this.registerEventListeners();\n\n        if (document.body.classList.contains(SELECTORS.MODECLASS)) {\n            document.body.setAttribute('data-bs-theme', 'dark');\n\n            ISACTIVATED = true;\n        } else {\n            document.body.setAttribute('data-bs-theme', 'light');\n        }\n\n        this.setTriggerStatus();\n    };\n\n    DarkMode.prototype.registerEventListeners = function() {\n        $(SELECTORS.TRIGGER).click(function() {\n            this.toggleDarkMode();\n        }.bind(this));\n    };\n\n    DarkMode.prototype.toggleDarkMode = function() {\n        $('body').toggleClass(SELECTORS.MODECLASS);\n\n        if (ISACTIVATED) {\n            document.body.setAttribute('data-bs-theme', 'light');\n        } else {\n            document.body.setAttribute('data-bs-theme', 'dark');\n        }\n\n        ISACTIVATED = !ISACTIVATED;\n\n        var request = Ajax.call([{\n            methodname: 'theme_moove_toggledarkmode',\n            args: {}\n        }]);\n\n        request[0].done(function() {\n            this.setTriggerStatus();\n        }.bind(this));\n    };\n\n    DarkMode.prototype.setTriggerStatus = function() {\n        if (ISACTIVATED) {\n            return $(SELECTORS.TRIGGER).attr('checked', 'checked');\n        }\n\n        return $(SELECTORS.TRIGGER).removeAttr('checked');\n    };\n\n    return {\n        'init': function() {\n            return new DarkMode();\n        }\n    };\n});"],"names":["define","$","Str","Ajax","SELECTORS","ISACTIVATED","DarkMode","registerEventListeners","document","body","classList","contains","setAttribute","setTriggerStatus","prototype","click","toggleDarkMode","bind","this","toggleClass","call","methodname","args","done","attr","removeAttr"],"mappings":";;;;;;AAqBAA,8BAAO,CAAC,SAAU,WAAY,cAAc,SAASC,EAAGC,IAAKC,UAErDC,kBACS,yBADTA,oBAEW,iBAGXC,aAAc,EAEdC,SAAW,gBACNC,yBAEDC,SAASC,KAAKC,UAAUC,SAASP,sBACjCI,SAASC,KAAKG,aAAa,gBAAiB,QAE5CP,aAAc,GAEdG,SAASC,KAAKG,aAAa,gBAAiB,cAG3CC,2BAGTP,SAASQ,UAAUP,uBAAyB,WACxCN,EAAEG,mBAAmBW,MAAM,gBAClBC,kBACPC,KAAKC,QAGXZ,SAASQ,UAAUE,eAAiB,WAChCf,EAAE,QAAQkB,YAAYf,qBAElBC,YACAG,SAASC,KAAKG,aAAa,gBAAiB,SAE5CJ,SAASC,KAAKG,aAAa,gBAAiB,QAGhDP,aAAeA,YAEDF,KAAKiB,KAAK,CAAC,CACrBC,WAAY,6BACZC,KAAM,MAGF,GAAGC,KAAK,gBACPV,oBACPI,KAAKC,QAGXZ,SAASQ,UAAUD,iBAAmB,kBAC9BR,YACOJ,EAAEG,mBAAmBoB,KAAK,UAAW,WAGzCvB,EAAEG,mBAAmBqB,WAAW,YAGpC,MACK,kBACG,IAAInB"}