{"version":3,"file":"toggle_shared.min.js","sources":["../src/toggle_shared.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Custom fields shared category toggle\r\n *\r\n * @module      core_customfield/toggle_shared\r\n * @copyright   2025 David Carrillo <davidmc@moodle.com>\r\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\n\"use strict\";\r\n\r\nimport 'core/inplace_editable';\r\nimport Notification from 'core/notification';\r\nimport Pending from 'core/pending';\r\nimport {toggleCategory} from 'core_customfield/repository/toggle_shared';\r\n\r\nlet initialized = false;\r\n\r\n/**\r\n * Initialise toggle\r\n */\r\nexport const init = () => {\r\n    if (initialized) {\r\n        // We already added the event listeners (can be called multiple times by mustache template).\r\n        return;\r\n    }\r\n\r\n    document.addEventListener('click', event => {\r\n        // Toggle shared category.\r\n        const sharedToggle = event.target.closest('[data-action=\"shared-toggle\"]');\r\n        if (sharedToggle) {\r\n            const pendingPromise = new Pending('core_customfield/shared:toggle');\r\n            const categoryId = sharedToggle.dataset.id;\r\n            const component = sharedToggle.dataset.component;\r\n            const area = sharedToggle.dataset.area;\r\n            const itemid = sharedToggle.dataset.itemid;\r\n            const sharedStateToggle = +!Number(sharedToggle.dataset.state);\r\n\r\n            toggleCategory(categoryId, component, area, itemid, sharedStateToggle)\r\n                .then(() => {\r\n                    sharedToggle.dataset.state = sharedStateToggle;\r\n                    return pendingPromise.resolve();\r\n                })\r\n                .catch(Notification.exception);\r\n        }\r\n    });\r\n\r\n    initialized = true;\r\n};\r\n"],"names":["initialized","document","addEventListener","event","sharedToggle","target","closest","pendingPromise","Pending","categoryId","dataset","id","component","area","itemid","sharedStateToggle","Number","state","then","resolve","catch","Notification","exception"],"mappings":"weA8BIA,aAAc,gBAKE,KACZA,cAKJC,SAASC,iBAAiB,SAASC,cAEzBC,aAAeD,MAAME,OAAOC,QAAQ,oCACtCF,aAAc,OACRG,eAAiB,IAAIC,iBAAQ,kCAC7BC,WAAaL,aAAaM,QAAQC,GAClCC,UAAYR,aAAaM,QAAQE,UACjCC,KAAOT,aAAaM,QAAQG,KAC5BC,OAASV,aAAaM,QAAQI,OAC9BC,oBAAsBC,OAAOZ,aAAaM,QAAQO,yCAEzCR,WAAYG,UAAWC,KAAMC,OAAQC,mBAC/CG,MAAK,KACFd,aAAaM,QAAQO,MAAQF,kBACtBR,eAAeY,aAEzBC,MAAMC,sBAAaC,eAIhCtB,aAAc"}