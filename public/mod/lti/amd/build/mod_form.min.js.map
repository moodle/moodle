{"version":3,"file":"mod_form.min.js","sources":["../src/mod_form.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Event handlers for the mod_lti mod_form.\r\n *\r\n * @module      mod_lti/mod_form\r\n * @copyright   2023 Jake Dallimore <jrhdallimore@gmail.com>\r\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\n\"use strict\";\r\n\r\nimport ContentItem from 'mod_lti/contentitem';\r\n\r\n/**\r\n * Initialise module.\r\n *\r\n * @param {int} courseId the course id.\r\n */\r\nconst init = (courseId) => {\r\n    const contentItemButton = document.querySelector('[name=\"selectcontent\"]');\r\n\r\n    if (!contentItemButton) {\r\n        return;\r\n    }\r\n\r\n    contentItemButton.addEventListener('click', () => {\r\n        const contentItemUrl = contentItemButton.getAttribute('data-contentitemurl');\r\n        const contentItemId = document.querySelector('#hidden_typeid').value;\r\n        if (contentItemId) {\r\n            const title = document.querySelector('#id_name').value.trim();\r\n            const text = document.querySelector('#id_introeditor').value.trim();\r\n            const postData = {\r\n                id: contentItemId,\r\n                course: courseId,\r\n                title: title,\r\n                text: text\r\n            };\r\n\r\n            // The callback below is called after the content item has been returned and processed.\r\n            ContentItem.init(contentItemUrl, postData, (returnData) => {\r\n                if (!returnData.multiple) {\r\n                    // The state of the grade checkbox has already been set by processContentItemReturnData() but that\r\n                    // hasn't fired the click/change event required by formslib to show/hide the dependent grade fields.\r\n                    // Fire it now.\r\n                    const allowGrades = document.querySelector('#id_instructorchoiceacceptgrades');\r\n                    let allowGradesChangeEvent = new Event('change');\r\n                    allowGrades.dispatchEvent(allowGradesChangeEvent);\r\n\r\n                    // If the tool is set to accept grades, make sure \"Point\" is selected.\r\n                    if (allowGrades.checked) {\r\n                        const gradeType = document.querySelector('#id_grade_modgrade_type');\r\n                        gradeType.value = \"point\";\r\n                        let gradeTypeChangeEvent = new Event('change');\r\n                        gradeType.dispatchEvent(gradeTypeChangeEvent);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    });\r\n};\r\n\r\nexport default {\r\n    init: init\r\n};\r\n"],"names":["init","courseId","contentItemButton","document","querySelector","addEventListener","contentItemUrl","getAttribute","contentItemId","value","title","trim","text","postData","id","course","returnData","multiple","allowGrades","allowGradesChangeEvent","Event","dispatchEvent","checked","gradeType","gradeTypeChangeEvent"],"mappings":"oQA2Ee,CACXA,KA5CUC,iBACJC,kBAAoBC,SAASC,cAAc,0BAE5CF,mBAILA,kBAAkBG,iBAAiB,SAAS,WAClCC,eAAiBJ,kBAAkBK,aAAa,uBAChDC,cAAgBL,SAASC,cAAc,kBAAkBK,SAC3DD,cAAe,OACTE,MAAQP,SAASC,cAAc,YAAYK,MAAME,OACjDC,KAAOT,SAASC,cAAc,mBAAmBK,MAAME,OACvDE,SAAW,CACbC,GAAIN,cACJO,OAAQd,SACRS,MAAOA,MACPE,KAAMA,2BAIEZ,KAAKM,eAAgBO,UAAWG,iBACnCA,WAAWC,SAAU,OAIhBC,YAAcf,SAASC,cAAc,wCACvCe,uBAAyB,IAAIC,MAAM,aACvCF,YAAYG,cAAcF,wBAGtBD,YAAYI,QAAS,OACfC,UAAYpB,SAASC,cAAc,2BACzCmB,UAAUd,MAAQ,YACde,qBAAuB,IAAIJ,MAAM,UACrCG,UAAUF,cAAcG"}