{"version":3,"file":"loading.min.js","sources":["../src/loading.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Tiny AI loading screen handling.\r\n *\r\n * @module      tiny_aiplacement/loading\r\n * @copyright   2024 Matt Porritt <matt.porritt@moodle.com>\r\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\nimport {getString} from 'core/str';\r\nimport {prefetchString} from 'core/prefetch';\r\n\r\nconst strings = [\r\n    {\r\n        key: 'loading_processing',\r\n        component: 'tiny_aiplacement',\r\n    },\r\n    {\r\n        key: 'loading_generating',\r\n        component: 'tiny_aiplacement',\r\n    },\r\n    {\r\n        key: 'loading_applying',\r\n        component: 'tiny_aiplacement',\r\n    },\r\n    {\r\n        key: 'loading_almostdone',\r\n        component: 'tiny_aiplacement',\r\n    }\r\n];\r\n\r\nstrings.forEach((string) => prefetchString(string.component, string.key));\r\n\r\n/**\r\n * Display a series of messages one by one with a specified delay between each message.\r\n *\r\n * Returns a promise that resolves when the final message is displayed.\r\n *\r\n * @param {HTMLElement} element The element to display the messages in.\r\n * @param {number} delay The delay between each message in milliseconds.\r\n * @returns {Promise<function(): void>} A function to stop the message cycling.\r\n */\r\nexport async function loadingMessages(element, delay = 6000) {\r\n    const sleep = (ms) => new Promise((resolve) => setTimeout(resolve, ms));\r\n\r\n    for (const {key, component} of strings) {\r\n        element.textContent = await getString(key, component);\r\n        await sleep(delay);\r\n    }\r\n\r\n    return;\r\n}\r\n"],"names":["element","delay","sleep","ms","Promise","resolve","setTimeout","key","component","strings","textContent","forEach","string"],"mappings":"4MAwDsCA,aAASC,6DAAQ,UAC7CC,MAASC,IAAO,IAAIC,SAASC,SAAYC,WAAWD,QAASF,UAE9D,MAAMI,IAACA,IAADC,UAAMA,aAAcC,QAC3BT,QAAQU,kBAAoB,kBAAUH,IAAKC,iBACrCN,MAAMD;;;;;;;;MAnCdQ,QAAU,CACZ,CACIF,IAAK,qBACLC,UAAW,oBAEf,CACID,IAAK,qBACLC,UAAW,oBAEf,CACID,IAAK,mBACLC,UAAW,oBAEf,CACID,IAAK,qBACLC,UAAW,qBAInBC,QAAQE,SAASC,SAAW,4BAAeA,OAAOJ,UAAWI,OAAOL"}