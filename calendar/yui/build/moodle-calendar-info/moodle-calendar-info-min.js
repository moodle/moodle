YUI.add("moodle-calendar-info",function(e,t){var n="aria-controls",r="aria-live",i="boundingBox",s="[data-core_calendar-title]",o="calendartable",u="core_calendar-",a=".",f="eventcontent",l="delay",c="eventtitle",h="innerHTML",p=function(){p.superclass.constructor.apply(this,arguments)};e.extend(p,e.Base,{_showTimer:null,_hideTimer:null,_panel:null,_currentDay:null,initializer:function(){var t=e.one(e.config.doc.body);t.delegate(["mouseenter","focus"],this._startShow,s,this),t.delegate(["mouseleave","blur"],this._startHide,s,this)},_initOverlay:function(){return this._panel||(this._panel=new e.Overlay({headerContent:e.Node.create('<h2 class="'+c+'"/>'),bodyContent:e.Node.create('<div class="'+f+'"/>'),visible:!1,render:!0}),this._panel.get(i).addClass("calendar-event-panel").setAttribute(r,"off"),this._panel.on("visibleChange",function(e){var t="assertive";e.prevVal&&!e.newVal&&(t="off"),this.get(i).setAttribute(r,t)})),this},_startShow:function(t){if(this._isCurrentDayVisible(t.currentTarget))return;this._cancelHide()._cancelShow()._initOverlay(),this._showTimer=setTimeout(e.bind(function(){var e=t.target.ancestor(s,!0);this._show(e)},this),this.get(l))},_show:function(t){var r=this._panel.get(i),s=e.WidgetPositionAlign,l=t.ancestor(a+o);r.one(a+c).set(h,t.getData(u+"title")),r.one(a+f).set(h,t.getData(u+"popupcontent")),this._currentDay&&this._currentDay.setAttribute(n,null),t.setAttribute(n,t.get("id")),t.appendChild(r),this._currentDay=t,this._panel.constrain(l),this._panel.set("width",l.get("offsetWidth")+"px").align(l,[s.TC,s.TC]).show(),r.setAttribute("tabindex","0").focus()},_cancelShow:function(){return this._showTimer&&clearTimeout(this._showTimer),this},_startHide:function(t){if(t.type==="blur"&&t.currentTarget.contains(t.target))return;this._cancelShow()._cancelHide(),this._hideTimer=setTimeout(e.bind(function(){this._hide()},this),this.get(l))},_hide:function(){this._panel&&this._panel.hide()},_cancelHide:function(){return this._hideTimer&&clearTimeout(this._hideTimer),this},_isCurrentDayVisible:function(e){return!this._panel||!this._panel.get("visible")?!1:e!==this._currentDay?!1:!0}},{NAME:"calendarInfo",ATTRS:{delay:{value:300}}}),e.namespace("M.core_calendar.info").init=function(e){return new p(e)}},"@VERSION@",{requires:["base","node","event-mouseenter","event-key","overlay","moodle-calendar-info-skin"]});
