{"version":3,"file":"local_email.min.js","sources":["../src/local_email.js"],"sourcesContent":["//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @module    local_email\n * @copyright 2021 Derick Turner\n * @author    Derick Turner\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function($) {\n\n    return {\n        init: function() {\n\n            function InsertAtCaret(myValue) {\n\n                return $(\".insertatcaretactive\").each(function() {\n                    if (typeof this.value === 'undefined') {\n                        var sel, range;\n                        if (window.getSelection) {\n                            sel = window.getSelection();\n                            if (sel.getRangeAt && sel.rangeCount) {\n                                range = sel.getRangeAt(0);\n                                range.deleteContents();\n                                range.insertNode( document.createTextNode(myValue) );\n                            }\n                        } else if (document.selection && document.selection.createRange) {\n                            document.selection.createRange().text = myValue;\n                        }\n                    } else {\n                        if (document.selection) {\n                            //For browsers like Internet Explorer\n                            this.focus();\n                            sel = document.selection.createRange();\n                            sel.text = myValue;\n                            this.focus();\n                        } else if (this.selectionStart || this.selectionStart == '0') {\n                            //For browsers like Firefox and Webkit based\n                            var startPos = this.selectionStart;\n                            var endPos = this.selectionEnd;\n                            var scrollTop = this.scrollTop;\n                            this.value = this.value.substring(0, startPos) +\n                                         myValue +\n                                         this.value.substring(endPos, this.value.length);\n                            this.focus();\n                            this.selectionStart = startPos + myValue.length;\n                            this.selectionEnd = startPos + myValue.length;\n                            this.scrollTop = scrollTop;\n                        } else {\n                            this.value += myValue;\n                            this.focus();\n                        }\n                    }\n                });\n            }\n\n\n            $(\".inputholder\").on(\"focus\", function() {\n                $(\".insertatcaretactive\").removeClass(\"insertatcaretactive\");\n                $(this).addClass(\"insertatcaretactive\");\n            });\n\n            $(\"#fitem_id_body_editor\").on(\"click\", function() {\n                var EditorInput = $(this).parent().find(\"#id_body_editoreditable\");\n                $(\".insertatcaretactive\").removeClass(\"insertatcaretactive\");\n                EditorInput.addClass(\"insertatcaretactive\");\n            });\n\n            $(\"#fitem_id_signature_editor\").on(\"click\", function() {\n                var EditorInput = $(this).parent().find(\"#id_body_editoreditable\");\n                $(\".insertatcaretactive\").removeClass(\"insertatcaretactive\");\n                EditorInput.addClass(\"insertatcaretactive\");\n            });\n\n            $('.clickforword').mousedown(function(e) {\n                e.preventDefault(); //to prevent the default behaviour of a tag\n                InsertAtCaret(\"{\" + this.text + \"}\" );\n            });\n\n            // Deal with edit allow button.\n            $('.emailclicktoedit').click(function(e) {\n                e.preventDefault(); //to prevent the default behaviour of a tag\n                $('#isediting').val(1);\n                $('#id_emailto').prop('disabled', false);\n                $('#id_emailtoother').prop('disabled', false);\n                $('#id_emailfrom').prop('disabled', false);\n                $('#id_emailfromother').prop('disabled', false);\n                $('#id_emailcc').prop('disabled', false);\n                $('#id_emailccother').prop('disabled', false);\n                $('#id_emailreplyto').prop('disabled', false);\n                $('#id_emailreplytoother').prop('disabled', false);\n                $('#id_subject').prop('disabled', false);\n                $('#id_body_editor').prop('disabled', false);\n                $('#id_companylogo').prop('disabled', false);\n                $('#id_signature_editor').prop('disabled', false);\n                $('#id_save').prop('disabled', false);\n                $('#id_edit').prop('disabled', true);\n            });\n        }\n    };\n});\n"],"names":["define","$","init","on","removeClass","this","addClass","EditorInput","parent","find","mousedown","e","myValue","preventDefault","text","each","sel","range","value","window","getSelection","getRangeAt","rangeCount","deleteContents","insertNode","document","createTextNode","selection","createRange","focus","selectionStart","startPos","endPos","selectionEnd","scrollTop","substring","length","click","val","prop"],"mappings":";;;;;;AAqBAA,iCAAO,CAAC,WAAW,SAASC,SAEjB,CACHC,KAAM,WA6CFD,EAAE,gBAAgBE,GAAG,SAAS,WAC1BF,EAAE,wBAAwBG,YAAY,uBACtCH,EAAEI,MAAMC,SAAS,0BAGrBL,EAAE,yBAAyBE,GAAG,SAAS,eAC/BI,YAAcN,EAAEI,MAAMG,SAASC,KAAK,2BACxCR,EAAE,wBAAwBG,YAAY,uBACtCG,YAAYD,SAAS,0BAGzBL,EAAE,8BAA8BE,GAAG,SAAS,eACpCI,YAAcN,EAAEI,MAAMG,SAASC,KAAK,2BACxCR,EAAE,wBAAwBG,YAAY,uBACtCG,YAAYD,SAAS,0BAGzBL,EAAE,iBAAiBS,WAAU,SAASC,OA5DfC,QA6DnBD,EAAEE,iBA7DiBD,QA8DL,IAAMP,KAAKS,KAAO,IA5DzBb,EAAE,wBAAwBc,MAAK,eAE1BC,IAAKC,cADa,IAAfZ,KAAKa,MAERC,OAAOC,cACPJ,IAAMG,OAAOC,gBACLC,YAAcL,IAAIM,cACtBL,MAAQD,IAAIK,WAAW,IACjBE,iBACNN,MAAMO,WAAYC,SAASC,eAAed,WAEvCa,SAASE,WAAaF,SAASE,UAAUC,cAChDH,SAASE,UAAUC,cAAcd,KAAOF,iBAGxCa,SAASE,eAEJE,SACLb,IAAMS,SAASE,UAAUC,eACrBd,KAAOF,aACNiB,aACF,GAAIxB,KAAKyB,gBAAyC,KAAvBzB,KAAKyB,eAAuB,KAEtDC,SAAW1B,KAAKyB,eAChBE,OAAS3B,KAAK4B,aACdC,UAAY7B,KAAK6B,eAChBhB,MAAQb,KAAKa,MAAMiB,UAAU,EAAGJ,UACxBnB,QACAP,KAAKa,MAAMiB,UAAUH,OAAQ3B,KAAKa,MAAMkB,aAChDP,aACAC,eAAiBC,SAAWnB,QAAQwB,YACpCH,aAAeF,SAAWnB,QAAQwB,YAClCF,UAAYA,oBAEZhB,OAASN,aACTiB,cA8BrB5B,EAAE,qBAAqBoC,OAAM,SAAS1B,GAClCA,EAAEE,iBACFZ,EAAE,cAAcqC,IAAI,GACpBrC,EAAE,eAAesC,KAAK,YAAY,GAClCtC,EAAE,oBAAoBsC,KAAK,YAAY,GACvCtC,EAAE,iBAAiBsC,KAAK,YAAY,GACpCtC,EAAE,sBAAsBsC,KAAK,YAAY,GACzCtC,EAAE,eAAesC,KAAK,YAAY,GAClCtC,EAAE,oBAAoBsC,KAAK,YAAY,GACvCtC,EAAE,oBAAoBsC,KAAK,YAAY,GACvCtC,EAAE,yBAAyBsC,KAAK,YAAY,GAC5CtC,EAAE,eAAesC,KAAK,YAAY,GAClCtC,EAAE,mBAAmBsC,KAAK,YAAY,GACtCtC,EAAE,mBAAmBsC,KAAK,YAAY,GACtCtC,EAAE,wBAAwBsC,KAAK,YAAY,GAC3CtC,EAAE,YAAYsC,KAAK,YAAY,GAC/BtC,EAAE,YAAYsC,KAAK,YAAY"}