'use strict';define(['jquery','block_ases/bootstrap','block_ases/sweetalert','block_ases/jqueryui','block_ases/select2'],function(a){return{init:function init(){function f(m,n){console.log('Adicionando: '+m),console.log('Identificador temporal cam_'+n),a('#form-preview').append(m),g()}function g(){a('#campoA').children('option').remove(),a('#campoB').children('option').remove(),a('#form-preview').children('div').each(function(){a('#campoA').append('<option value="'+a(this).attr('id')+'">'+a(this).attr('id')+'</option>'),a('#campoB').append('<option value="'+a(this).attr('id')+'">'+a(this).attr('id')+'</option>')})}function h(){return Math.floor(100*Math.random()+900)}function i(m,n,o){if(!m||!n)return void alert('Seleccione primero un par de campos.');var p=null;'>'===o?p='Mayor que':'<'===o?p='Menor que':'EQUAL'===o?p='Igual que':'DIFFERENT'===o?p='Diferente que':'BOUND'===o?p='Depende de':void 0;var q='<div class="regla" data-campo-a="'+m+'" data-campo-b="'+n+'" data-regla="'+o+'">                                '+m+' - <i>'+p+'</i> - '+n+'                                 <div class="btn btn-danger btn-xs eliminar-regla">                                    eliminar                                </div>                            </div>';a('#contenedor-reglas').append(q)}function j(){var m=0,n=JSON.parse('[]'),o=JSON.parse('[]');a('#form-preview').children('div').each(function(){var u='';o.push(JSON.parse('{ "id_temporal":"'+a(this).attr('id')+'", "id_nuevo":"cam_'+m+'" }'));var v='cam_'+m,w='null';a(this).find('.opcionesCampo').val()&&(w=a(this).find('.opcionesCampo').val());var y='null';a(this).find('.atributosCampo').val()&&(y=a(this).find('.atributosCampo').val());var z='null';a(this).find('.permisosCampo').val()&&(z=a(this).find('.permisosCampo').val());u='                    {                            "id_temporal":"'+v+'",                            "enunciado":"'+a(this).find('.enunciado').val()+'",                            "tipo_campo":"'+a(this).attr('data-tipo-campo')+'",                            "opciones_campo":'+w+',                            "atributos_campo":'+y+',                            "permisos_campo":'+z+'                        }                    ',n.push(JSON.parse(u)),u='',++m});var p=JSON.parse('[]');a('#contenedor-reglas').children('.regla').each(function(){var u=a(this).attr('data-campo-a'),v=a(this).attr('data-campo-b'),w=a(this).attr('data-regla');for(var y in o)o[y].id_temporal==u&&(u=o[y].id_nuevo),o[y].id_temporal==v&&(v=o[y].id_nuevo);p.push(JSON.parse('{                            "id_temporal_campo_a":"'+u+'",                            "id_temporal_campo_b":"'+v+'",                            "regla":"'+w+'"                        }'))});var q=JSON.parse('[]');if(a('#disparadores').val()){for(var r in q=a('#disparadores').val(),o)q=q.replaceAll(o[r].id_temporal,o[r].id_nuevo);q=JSON.parse(q)}var s={datos_formulario:{nombre:a('#titulo-formulario').val(),descripcion:a('#desc-formulario').val(),method:a('#metodo-formulario').val(),action:a('#procesador-formulario').val(),enctype:a('#enctype-formulario').val()},preguntas:n,disparadores:q,reglas:p};l(s)}function l(m){console.log(m),a.ajax({method:'POST',url:'../managers/dphpforms/dphpforms_forms_processor.php',contentType:'application/json',dataType:'text',data:JSON.stringify(m),success:function success(n){alert(n),console.log(n)},error:function error(n,o,p){alert('some error '+o+' '+p),console.log('some error '+o+' '+p),console.log(n)}})}a(document).ready(function(){a('#JSON-condiciones').text(JSON.stringify([{disparador:'cam_xxx',condiciones:[{condicion:'marcado',comportamiento_condicion_cumplida:[{campo:'cam_xxx',permisos:[{rol:0,permisos:['lectura','escritura']}]},{campo:'cam_xxx+1',permisos:[{rol:0,permisos:['lectura']},{rol:1,permisos:['lectura']},{rol:2,permisos:['lectura','escritura']}]}],comportamiento_condicion_no_cumplida:[{campo:'cam_xxx+1',permisos:[{rol:0,permisos:['lectura','escritura']},{rol:1,permisos:['lectura','escritura']},{rol:2,permisos:['lectura']}]}]}]}],void 0,2))}),a('#btn-registro-regla').click(function(){var m=a('#campoA option:selected').val(),n=a('#campoB option:selected').val(),o=a('#selector-reglas option:selected').val();i(m,n,o)}),a('#verOpcionesAvanzadas').click(function(){a('#opcionesAvanzadas').fadeIn(400),a(this).hide()}),a('#generarFormulario').click(function(){j()}),a('#json-store-form').click(function(){var m=JSON.parse(a('#opt1-textarea-json').val());l(m)}),a('#titulo-formulario').on('keyup',function(){a('#form-preview > h2').text(a('#titulo-formulario').val())}),a(document).on('click','.btn-eliminar-campo',function(){a(this).parent().remove(),g()}),a(document).on('click','.eliminar-regla',function(){a(this).parent().remove(),g()}),a(document).on('keyup','.enunciado',function(){a(this).parent().find('.label-text').text(a(this).val())});a('li').click(function(){var m=a(this);if(console.log(m.attr('id')),'caja-texto'==m.attr('id')){var n=h(),o='<div id="cam_'+n+'" class="form-group div-box-preview" data-tipo-Campo="TEXTFIELD">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+n+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualizaci\xF3n del enunciado</label>                                    <input type="text" class="form-control" name="TEXTFIELD">                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(o,n)}if('caja-parrafo'==m.attr('id')){var n=h(),o='<div id="cam_'+n+'" class="form-group div-box-preview" data-tipo-campo="TEXTAREA">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+n+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualizaci\xF3n del enunciado</label>                                    <textarea class="form-control" name="TEXTAREA"></textarea>                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(o,n)}if('caja-fecha'==m.attr('id')){var n=h(),o='<div id="cam_'+n+'" class="form-group div-box-preview" data-tipo-campo="DATE">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+n+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualizaci\xF3n del enunciado</label>                                    <input type="date" class="form-control" name="DATE">                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(o,n)}if('caja-hora'==m.attr('id')){var n=h(),o='<div id="cam_'+n+'" class="form-group div-box-preview" data-tipo-campo="TIME">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+n+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualizaci\xF3n del enunciado</label>                                    <input type="time" class="form-control" name="TIME">                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(o,n)}if('caja-radio'==m.attr('id')){var n=h(),o='<div id="cam_'+n+'" class="form-group div-box-preview" data-tipo-campo="RADIOBUTTON">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+n+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea rows="5" class="form-control opcionesCampo" placeholder="Elementos: [{ &#34;enunciado&#34;:&#34;texto&#34;, &#34;valor&#34;:&#34;valor&#34;, &#34;posicion&#34;: &#34;n\xFAmero&#34;}] \n\nejemplo: [{ &#34;enunciado&#34;:&#34;S\xED&#34;, &#34;valor&#34;:&#34;1&#34;, &#34;posicion&#34;: &#34;0&#34;}, { &#34;enunciado&#34;:&#34;No&#34;, &#34;valor&#34;:&#34;0&#34;, &#34;posicion&#34;: &#34;1&#34;}]"></textarea>                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(o,n)}if('caja-checkbox'==m.attr('id')){var n=h(),o='<div id="cam_'+n+'" class="form-group div-box-preview" data-tipo-campo="CHECKBOX">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+n+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea rows="5" class="form-control opcionesCampo" placeholder="Elementos: [{ &#34;enunciado&#34;:&#34;texto&#34;, &#34;valor&#34;:&#34;valor&#34;, &#34;checked&#34;:&#34;true&#34;, &#34;posicion&#34;: &#34;n\xFAmero&#34;}] \n\nejemplo: [{ &#34;enunciado&#34;:&#34;S\xED&#34;, &#34;valor&#34;:&#34;1&#34;, &#34;posicion&#34;: &#34;0&#34;}, { &#34;enunciado&#34;:&#34;No&#34;, &#34;valor&#34;:&#34;0&#34;, &#34;posicion&#34;: &#34;1&#34;}]"></textarea>                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(o,n)}});a('.limpiar').click(function(){a(this).parent().find('div').each(function(){a(this).find('label').find('input').prop('checked',!1)})}),String.prototype.replaceAll=function(m,n){return void 0===n?this.toString():this.split(m).join(n)}}}});